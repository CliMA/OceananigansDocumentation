<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Buoyancy models and equation of state · Oceananigans.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://clima.github.io/OceananigansDocumentation/stable/model_setup/buoyancy_and_equation_of_state/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Oceananigans.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../installation_instructions/">Installation instructions</a></li><li><a class="tocitem" href="../../using_gpus/">Using GPUs</a></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/one_dimensional_diffusion/">One-dimensional diffusion</a></li><li><a class="tocitem" href="../../generated/geostrophic_adjustment/">Geostrophic adjustment</a></li><li><a class="tocitem" href="../../generated/two_dimensional_turbulence/">Two-dimensional turbulence</a></li><li><a class="tocitem" href="../../generated/internal_wave/">Internal wave</a></li><li><a class="tocitem" href="../../generated/convecting_plankton/">Convecting plankton</a></li><li><a class="tocitem" href="../../generated/ocean_wind_mixing_and_convection/">Ocean wind mixing and convection</a></li><li><a class="tocitem" href="../../generated/langmuir_turbulence/">Langmuir turbulence</a></li><li><a class="tocitem" href="../../generated/eady_turbulence/">Eady turbulence</a></li><li><a class="tocitem" href="../../generated/kelvin_helmholtz_instability/">Kelvin-Helmholtz instability</a></li><li><a class="tocitem" href="../../generated/shallow_water_Bickley_jet/">Shallow water Bickley jet</a></li><li><a class="tocitem" href="../../generated/horizontal_convection/">Horizontal convection</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Physics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../physics/notation/">Coordinate system and notation</a></li><li><a class="tocitem" href="../../physics/boussinesq/">Boussinesq approximation</a></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox"/><label class="tocitem" for="menuitem-5-3"><span class="docs-label"><code>NonhydrostaticModel</code></span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../physics/nonhydrostatic_model/">Nonhydrostatic model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-4" type="checkbox"/><label class="tocitem" for="menuitem-5-4"><span class="docs-label"><code>HydrostaticFreeSurfaceModel</code></span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../physics/hydrostatic_free_surface_model/">Hydrostatic model with a free surface</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-5" type="checkbox"/><label class="tocitem" for="menuitem-5-5"><span class="docs-label"><code>ShallowWaterModel</code></span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../physics/shallow_water_model/">Shallow water model</a></li></ul></li><li><a class="tocitem" href="../../physics/buoyancy_and_equations_of_state/">Buoyancy models and equations of state</a></li><li><a class="tocitem" href="../../physics/coriolis_forces/">Coriolis forces</a></li><li><a class="tocitem" href="../../physics/turbulence_closures/">Turbulence closures</a></li><li><a class="tocitem" href="../../physics/surface_gravity_waves/">Surface gravity waves and the Craik-Leibovich approximation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Numerical implementation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../numerical_implementation/finite_volume/">Finite volume method</a></li><li><a class="tocitem" href="../../numerical_implementation/spatial_operators/">Spatial operators</a></li><li><a class="tocitem" href="../../numerical_implementation/pressure_decomposition/">Pressure decomposition</a></li><li><a class="tocitem" href="../../numerical_implementation/time_stepping/">Time stepping</a></li><li><a class="tocitem" href="../../numerical_implementation/boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../../numerical_implementation/poisson_solvers/">Poisson solvers</a></li><li><a class="tocitem" href="../../numerical_implementation/large_eddy_simulation/">Large eddy simulation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox" checked/><label class="tocitem" for="menuitem-7"><span class="docs-label">Model setup</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../overview/">Overview</a></li><li><a class="tocitem" href="../architecture/">Architecture</a></li><li><a class="tocitem" href="../number_type/">Number type</a></li><li><a class="tocitem" href="../grids/">Grid</a></li><li><a class="tocitem" href="../clock/">Clock</a></li><li><a class="tocitem" href="../coriolis/">Coriolis (rotation)</a></li><li><a class="tocitem" href="../tracers/">Tracers</a></li><li class="is-active"><a class="tocitem" href>Buoyancy models and equation of state</a><ul class="internal"><li><a class="tocitem" href="#No-buoyancy"><span>No buoyancy</span></a></li><li><a class="tocitem" href="#Buoyancy-as-a-tracer"><span>Buoyancy as a tracer</span></a></li><li><a class="tocitem" href="#Seawater-buoyancy"><span>Seawater buoyancy</span></a></li></ul></li><li><a class="tocitem" href="../boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../forcing_functions/">Forcing functions</a></li><li><a class="tocitem" href="../background_fields/">Background fields</a></li><li><a class="tocitem" href="../turbulent_diffusivity_closures_and_les_models/">Turbulent diffusivity closures and LES models</a></li><li><a class="tocitem" href="../lagrangian_particles/">Lagrangian particles</a></li><li><a class="tocitem" href="../diagnostics/">Diagnostics</a></li><li><a class="tocitem" href="../output_writers/">Output writers</a></li><li><a class="tocitem" href="../checkpointing/">Checkpointing</a></li><li><a class="tocitem" href="../setting_initial_conditions/">Setting initial conditions</a></li></ul></li><li><a class="tocitem" href="../../simulation_tips/">Simulation tips</a></li><li><a class="tocitem" href="../../contributing/">Contributor&#39;s guide</a></li><li><a class="tocitem" href="../../gallery/">Gallery</a></li><li><a class="tocitem" href="../../references/">References</a></li><li><input class="collapse-toggle" id="menuitem-12" type="checkbox"/><label class="tocitem" for="menuitem-12"><span class="docs-label">Appendix</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../appendix/staggered_grid/">Staggered grid</a></li><li><a class="tocitem" href="../../appendix/fractional_step/">Fractional step method</a></li><li><a class="tocitem" href="../../appendix/convergence_tests/">Convergence tests</a></li><li><a class="tocitem" href="../../appendix/benchmarks/">Performance benchmarks</a></li><li><a class="tocitem" href="../../appendix/library/">Library</a></li><li><a class="tocitem" href="../../appendix/function_index/">Function index</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Model setup</a></li><li class="is-active"><a href>Buoyancy models and equation of state</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Buoyancy models and equation of state</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/CliMA/Oceananigans.jl/blob/master/docs/src/model_setup/buoyancy_and_equation_of_state.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Buoyancy-models-and-equations-of-state"><a class="docs-heading-anchor" href="#Buoyancy-models-and-equations-of-state">Buoyancy models and equations of state</a><a id="Buoyancy-models-and-equations-of-state-1"></a><a class="docs-heading-anchor-permalink" href="#Buoyancy-models-and-equations-of-state" title="Permalink"></a></h1><p>The buoyancy option selects how buoyancy is treated. There are currently three options:</p><ol><li>No buoyancy (and no gravity).</li><li>Evolve buoyancy as a tracer.</li><li><em>Seawater buoyancy</em>: evolve temperature <span>$T$</span> and salinity <span>$S$</span> as tracers with a value for the gravitational acceleration <span>$g$</span> and an equation of state of your choosing. This is the default setting.</li></ol><h2 id="No-buoyancy"><a class="docs-heading-anchor" href="#No-buoyancy">No buoyancy</a><a id="No-buoyancy-1"></a><a class="docs-heading-anchor-permalink" href="#No-buoyancy" title="Permalink"></a></h2><p>To turn off buoyancy (and gravity) simply pass <code>buoyancy = nothing</code> to the model constructor.</p><pre><code class="language-julia-repl hljs">julia&gt; grid = RegularRectilinearGrid(size=(64, 64, 64), extent=(1, 1, 1));

julia&gt; model = NonhydrostaticModel(grid=grid, buoyancy=nothing)
NonhydrostaticModel{CPU, Float64}(time = 0 seconds, iteration = 0)
├── grid: RegularRectilinearGrid{Float64, Periodic, Periodic, Bounded}(Nx=64, Ny=64, Nz=64)
├── tracers: (:T, :S)
├── closure: Nothing
├── buoyancy: Nothing
└── coriolis: Nothing</code></pre><p>In this case, you might want to explicitly specify which tracers to evolve. In particular, you may not want to evolve temperature and salinity, which are included by default. To specify no tracers, also pass<code>tracers = ()</code> to the model constructor.</p><pre><code class="language-julia-repl hljs">julia&gt; model = NonhydrostaticModel(grid=grid, buoyancy=nothing, tracers=())
NonhydrostaticModel{CPU, Float64}(time = 0 seconds, iteration = 0)
├── grid: RegularRectilinearGrid{Float64, Periodic, Periodic, Bounded}(Nx=64, Ny=64, Nz=64)
├── tracers: ()
├── closure: Nothing
├── buoyancy: Nothing
└── coriolis: Nothing</code></pre><h2 id="Buoyancy-as-a-tracer"><a class="docs-heading-anchor" href="#Buoyancy-as-a-tracer">Buoyancy as a tracer</a><a id="Buoyancy-as-a-tracer-1"></a><a class="docs-heading-anchor-permalink" href="#Buoyancy-as-a-tracer" title="Permalink"></a></h2><p>To directly evolve buoyancy as a tracer simply pass <code>buoyancy = BuoyancyTracer()</code> to the model constructor. BuoyancyModels <code>:b</code> must be included as a tracer, for example,</p><pre><code class="language-julia-repl hljs">julia&gt; model = NonhydrostaticModel(grid=grid, buoyancy=BuoyancyTracer(), tracers=(:b))
NonhydrostaticModel{CPU, Float64}(time = 0 seconds, iteration = 0)
├── grid: RegularRectilinearGrid{Float64, Periodic, Periodic, Bounded}(Nx=64, Ny=64, Nz=64)
├── tracers: (:b,)
├── closure: Nothing
├── buoyancy: BuoyancyTracer
└── coriolis: Nothing</code></pre><h2 id="Seawater-buoyancy"><a class="docs-heading-anchor" href="#Seawater-buoyancy">Seawater buoyancy</a><a id="Seawater-buoyancy-1"></a><a class="docs-heading-anchor-permalink" href="#Seawater-buoyancy" title="Permalink"></a></h2><p>To evolve temperature <span>$T$</span> and salinity <span>$S$</span> and diagnose the buoyancy, you can pass <code>buoyancy = SeawaterBuoyancy()</code> which is the default.</p><pre><code class="language-julia-repl hljs">julia&gt; model = NonhydrostaticModel(grid=grid, buoyancy=SeawaterBuoyancy())
NonhydrostaticModel{CPU, Float64}(time = 0 seconds, iteration = 0)
├── grid: RegularRectilinearGrid{Float64, Periodic, Periodic, Bounded}(Nx=64, Ny=64, Nz=64)
├── tracers: (:T, :S)
├── closure: Nothing
├── buoyancy: SeawaterBuoyancy{Float64, LinearEquationOfState{Float64}, Nothing, Nothing}
└── coriolis: Nothing</code></pre><p>Without any options specified, a value of <span>$g = 9.80665 \, \text{m}\,\text{s}^{-2}$</span> is used for the gravitational acceleration (corresponding to <a href="https://en.wikipedia.org/wiki/Standard_gravity">standard gravity</a>) along with a linear equation of state with thermal expansion and haline contraction coefficients suitable for seawater.</p><p>If, for example, you wanted to simulate fluids on another planet such as Europa where <span>$g = 1.3 \, \text{m}\,\text{s}^{-2}$</span>, then use</p><pre><code class="language-julia-repl hljs">julia&gt; buoyancy = SeawaterBuoyancy(gravitational_acceleration=1.3)
SeawaterBuoyancy{Float64}: g = 1.3
└── equation of state: LinearEquationOfState{Float64}: α = 1.67e-04, β = 7.80e-04

julia&gt; model = NonhydrostaticModel(grid=grid, buoyancy=buoyancy)
NonhydrostaticModel{CPU, Float64}(time = 0 seconds, iteration = 0)
├── grid: RegularRectilinearGrid{Float64, Periodic, Periodic, Bounded}(Nx=64, Ny=64, Nz=64)
├── tracers: (:T, :S)
├── closure: Nothing
├── buoyancy: SeawaterBuoyancy{Float64, LinearEquationOfState{Float64}, Nothing, Nothing}
└── coriolis: Nothing</code></pre><p>When using <code>SeawaterBuoyancy</code> temperature <code>:T</code> and salinity <code>:S</code> tracers must be specified. Explicitly this can be accomplished by passing <code>tracers = (:T, :S)</code> to a model constructor.</p><h3 id="Linear-equation-of-state"><a class="docs-heading-anchor" href="#Linear-equation-of-state">Linear equation of state</a><a id="Linear-equation-of-state-1"></a><a class="docs-heading-anchor-permalink" href="#Linear-equation-of-state" title="Permalink"></a></h3><p>To use non-default thermal expansion and haline contraction coefficients, say <span>$\alpha = 2 \times 10^{-3} \; \text{K}^{-1}$</span> and <span>$\beta = 5 \times 10^{-4} \text{psu}^{-1}$</span> corresponding to some other fluid, then use</p><pre><code class="language-julia-repl hljs">julia&gt; buoyancy = SeawaterBuoyancy(equation_of_state=LinearEquationOfState(α=2e-3, β=5e-4))
SeawaterBuoyancy{Float64}: g = 9.80665
└── equation of state: LinearEquationOfState{Float64}: α = 2.00e-03, β = 5.00e-04</code></pre><h3 id="Idealized-nonlinear-equations-of-state"><a class="docs-heading-anchor" href="#Idealized-nonlinear-equations-of-state">Idealized nonlinear equations of state</a><a id="Idealized-nonlinear-equations-of-state-1"></a><a class="docs-heading-anchor-permalink" href="#Idealized-nonlinear-equations-of-state" title="Permalink"></a></h3><p>Instead of a linear equation of state, five idealized (second-order) nonlinear equation of state as described by <a href="../../references/#Roquet15Idealized">Fabien Roquet, Gurvan Madec, Laurent Brodeau, J. Nycander (2015)</a> may be used. These equations of state are provided via the <a href="https://github.com/CliMA/SeawaterPolynomials.jl">SeawaterPolynomials.jl</a> package.</p><pre><code class="language-julia-repl hljs">julia&gt; using SeawaterPolynomials.SecondOrderSeawaterPolynomials

julia&gt; eos = RoquetSeawaterPolynomial(:Freezing)
SecondOrderSeawaterPolynomial{Float64}(0.7718, -0.0491, 0.0, -2.5681e-5, 0.0, -0.005027, 0.0)

julia&gt; buoyancy = SeawaterBuoyancy(equation_of_state=eos)
SeawaterBuoyancy{Float64}: g = 9.80665
└── equation of state: SeawaterPolynomials.SecondOrderSeawaterPolynomials.SecondOrderSeawaterPolynomial{Float64}(0.7718, -0.0491, 0.0, -2.5681e-5, 0.0, -0.005027, 0.0)</code></pre><h3 id="TEOS-10-equation-of-state"><a class="docs-heading-anchor" href="#TEOS-10-equation-of-state">TEOS-10 equation of state</a><a id="TEOS-10-equation-of-state-1"></a><a class="docs-heading-anchor-permalink" href="#TEOS-10-equation-of-state" title="Permalink"></a></h3><p>A high-accuracy 55-term polynomial approximation to the TEOS-10 equation of state suitable for use in Boussinesq models as described by <a href="../../references/#Roquet15TEOS">F. Roquet, G. Madec, Trevor J. McDougall, Paul M. Barker (2015)</a> is implemented in the <a href="https://github.com/CliMA/SeawaterPolynomials.jl">SeawaterPolynomials.jl</a> package and may be used.</p><pre><code class="language-julia-repl hljs">julia&gt; using SeawaterPolynomials.TEOS10

julia&gt; eos = TEOS10EquationOfState()
SeawaterPolynomials.BoussinesqEquationOfState{TEOS10SeawaterPolynomial{Float64}, Int64}(TEOS10SeawaterPolynomial{Float64}(), 1020)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tracers/">« Tracers</a><a class="docs-footer-nextpage" href="../boundary_conditions/">Boundary conditions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.5 on <span class="colophon-date" title="Tuesday 14 September 2021 22:44">Tuesday 14 September 2021</span>. Using Julia version 1.6.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
