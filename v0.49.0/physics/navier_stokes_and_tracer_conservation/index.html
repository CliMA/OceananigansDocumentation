<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Navier-Stokes and tracer conservation equations · Oceananigans.jl</title><link rel="canonical" href="https://clima.github.io/OceananigansDocumentation/stable/physics/navier_stokes_and_tracer_conservation/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Oceananigans.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../installation_instructions/">Installation instructions</a></li><li><a class="tocitem" href="../../using_gpus/">Using GPUs</a></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/one_dimensional_diffusion/">One-dimensional diffusion</a></li><li><a class="tocitem" href="../../generated/geostrophic_adjustment/">Geostrophic adjustment</a></li><li><a class="tocitem" href="../../generated/two_dimensional_turbulence/">Two-dimensional turbulence</a></li><li><a class="tocitem" href="../../generated/internal_wave/">Internal wave</a></li><li><a class="tocitem" href="../../generated/convecting_plankton/">Convecting plankton</a></li><li><a class="tocitem" href="../../generated/ocean_wind_mixing_and_convection/">Ocean wind mixing and convection</a></li><li><a class="tocitem" href="../../generated/langmuir_turbulence/">Langmuir turbulence</a></li><li><a class="tocitem" href="../../generated/eady_turbulence/">Eady turbulence</a></li><li><a class="tocitem" href="../../generated/kelvin_helmholtz_instability/">Kelvin-Helmholtz instability</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Model setup</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_setup/overview/">Overview</a></li><li><a class="tocitem" href="../../model_setup/architecture/">Architecture</a></li><li><a class="tocitem" href="../../model_setup/number_type/">Number type</a></li><li><a class="tocitem" href="../../model_setup/grids/">Grid</a></li><li><a class="tocitem" href="../../model_setup/clock/">Clock</a></li><li><a class="tocitem" href="../../model_setup/coriolis/">Coriolis (rotation)</a></li><li><a class="tocitem" href="../../model_setup/tracers/">Tracers</a></li><li><a class="tocitem" href="../../model_setup/buoyancy_and_equation_of_state/">Buoyancy and equation of state</a></li><li><a class="tocitem" href="../../model_setup/boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../../model_setup/forcing_functions/">Forcing functions</a></li><li><a class="tocitem" href="../../model_setup/background_fields/">Background fields</a></li><li><a class="tocitem" href="../../model_setup/turbulent_diffusivity_closures_and_les_models/">Turbulent diffusivity closures and LES models</a></li><li><a class="tocitem" href="../../model_setup/lagrangian_particles/">Lagrangian particles</a></li><li><a class="tocitem" href="../../model_setup/diagnostics/">Diagnostics</a></li><li><a class="tocitem" href="../../model_setup/output_writers/">Output writers</a></li><li><a class="tocitem" href="../../model_setup/checkpointing/">Checkpointing</a></li><li><a class="tocitem" href="../../model_setup/setting_initial_conditions/">Setting initial conditions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox" checked/><label class="tocitem" for="menuitem-6"><span class="docs-label">Physics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Navier-Stokes and tracer conservation equations</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#The-Boussinesq-Navier-Stokes-equations-and-tracer-conservation-equations"><span>The Boussinesq Navier-Stokes equations and tracer conservation equations</span></a></li><li><a class="tocitem" href="#The-momentum-conservation-equation"><span>The momentum conservation equation</span></a></li><li><a class="tocitem" href="#The-tracer-conservation-equation"><span>The tracer conservation equation</span></a></li></ul></li><li><a class="tocitem" href="../coriolis_forces/">Coriolis forces</a></li><li><a class="tocitem" href="../buoyancy_and_equations_of_state/">Buoyancy model and equations of state</a></li><li><a class="tocitem" href="../turbulence_closures/">Turbulence closures</a></li><li><a class="tocitem" href="../surface_gravity_waves/">Surface gravity waves and the Craik-Leibovich approximation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Numerical implementation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../numerical_implementation/pressure_decomposition/">Pressure decomposition</a></li><li><a class="tocitem" href="../../numerical_implementation/time_stepping/">Time stepping</a></li><li><a class="tocitem" href="../../numerical_implementation/finite_volume/">Finite volume method</a></li><li><a class="tocitem" href="../../numerical_implementation/spatial_operators/">Spatial operators</a></li><li><a class="tocitem" href="../../numerical_implementation/boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../../numerical_implementation/poisson_solvers/">Poisson solvers</a></li><li><a class="tocitem" href="../../numerical_implementation/large_eddy_simulation/">Large eddy simulation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Validation experiments</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../validation/convergence_tests/">Convergence tests</a></li><li><a class="tocitem" href="../../validation/lid_driven_cavity/">Lid-driven cavity</a></li><li><a class="tocitem" href="../../validation/stratified_couette_flow/">Stratified Couette flow</a></li></ul></li><li><a class="tocitem" href="../../gallery/">Gallery</a></li><li><a class="tocitem" href="../../benchmarks/">Performance benchmarks</a></li><li><a class="tocitem" href="../../contributing/">Contributor&#39;s guide</a></li><li><input class="collapse-toggle" id="menuitem-12" type="checkbox"/><label class="tocitem" for="menuitem-12"><span class="docs-label">Appendix</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../appendix/staggered_grid/">Staggered grid</a></li><li><a class="tocitem" href="../../appendix/fractional_step/">Fractional step method</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li><li><a class="tocitem" href="../../library/">Library</a></li><li><a class="tocitem" href="../../function_index/">Function index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Physics</a></li><li class="is-active"><a href>Navier-Stokes and tracer conservation equations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Navier-Stokes and tracer conservation equations</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/CliMA/Oceananigans.jl/blob/master/docs/src/physics/navier_stokes_and_tracer_conservation.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Coordinate-system-and-notation"><a class="docs-heading-anchor" href="#Coordinate-system-and-notation">Coordinate system and notation</a><a id="Coordinate-system-and-notation-1"></a><a class="docs-heading-anchor-permalink" href="#Coordinate-system-and-notation" title="Permalink"></a></h1><p>Oceananigans.jl is formulated in a Cartesian coordinate system <span>$\bm{x} = (x, y, z)$</span> with unit vectors <span>$\bm{\hat x}$</span>, <span>$\bm{\hat y}$</span>, and <span>$\bm{\hat z}$</span>, where <span>$\bm{\hat x}$</span> points east, <span>$\bm{\hat y}$</span> points north, and <span>$\bm{\hat z}$</span> points &#39;upward&#39;, opposite the direction of gravitational acceleration. We denote time with <span>$t$</span>, partial derivatives with respect to time <span>$t$</span> or a coordinate <span>$x$</span> with <span>$\partial_t$</span> or <span>$\partial_x$</span>, and denote the gradient operator <span>$\bm{\nabla} \equiv \partial_x \bm{\hat x} + \partial_y \bm{\hat y} + \partial_z \bm{\hat z}$</span>. We use <span>$u$</span>, <span>$v$</span>, and <span>$w$</span> to denote the east, north, and vertical velocity components, such that <span>$\bm{u} = u \bm{\hat x} + v \bm{\hat y} + w \bm{\hat z}$</span>.</p><h1 id="The-Boussinesq-Navier-Stokes-equations-and-tracer-conservation-equations"><a class="docs-heading-anchor" href="#The-Boussinesq-Navier-Stokes-equations-and-tracer-conservation-equations">The Boussinesq Navier-Stokes equations and tracer conservation equations</a><a id="The-Boussinesq-Navier-Stokes-equations-and-tracer-conservation-equations-1"></a><a class="docs-heading-anchor-permalink" href="#The-Boussinesq-Navier-Stokes-equations-and-tracer-conservation-equations" title="Permalink"></a></h1><p>Oceananigans.jl solves the incompressible Navier-Stokes equations under the Boussinesq approximation<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup> and an arbitrary number of tracer conservation equations. Physics associated with individual terms in the momentum and tracer conservation equations –- the background rotation rate of the equation&#39;s reference frame, gravitational effects associated with buoyant tracers under the Boussinesq approximation, generalized stresses and tracer fluxes associated with viscous and diffusive physics, and arbitrary &quot;forcing functions&quot; –- are determined by the whims of the user.</p><p>The fluid density <span>$\rho$</span> in Oceananigans.jl is, in general, decomposed into three components:</p><p class="math-container">\[    \rho(\bm{x}, t) = \rho_0 + \rho_*(z) + \rho&#39;(\bm{x}, t) \, ,\]</p><p>where <span>$\rho_0$</span> is a constant &#39;reference&#39; density, <span>$\rho_*(z)$</span> is a background density profile which, when non-zero, is typically associated with the hydrostatic compression of seawater in the deep ocean, and <span>$\rho&#39;(\bm{x}, t)$</span> is the dynamic component of density corresponding to inhomogeneous distributions of a buoyant tracer such as temperature or salinity. The fluid <em>buoyancy</em>, associated with the buoyant acceleration of fluid, is defined in terms of <span>$\rho&#39;$</span> as</p><p class="math-container">\[    b = - \frac{g \rho&#39;}{\rho_0} \, ,\]</p><p>where <span>$g$</span> is gravitational acceleration.</p><p>The Boussinesq approximation is valid when <span>$\rho_* + \rho&#39; \ll \rho_0$</span>, which implies the fluid is <em>approximately</em> incompressible, and thus does not support acoustic waves. In this case, the mass conservation equation reduces to the continuity equation</p><p class="math-container">\[    \bm{\nabla} \bm{\cdot} \bm{u} = \partial_x u + \partial_y v + \partial_z w = 0 \, .
    \tag{eq:continuity}\]</p><h2 id="The-momentum-conservation-equation"><a class="docs-heading-anchor" href="#The-momentum-conservation-equation">The momentum conservation equation</a><a id="The-momentum-conservation-equation-1"></a><a class="docs-heading-anchor-permalink" href="#The-momentum-conservation-equation" title="Permalink"></a></h2><p>The equations governing the conservation of momentum in a rotating fluid, including buoyancy via the Boussinesq approximation and including the averaged effects of surface gravity waves at the top of the domain via the Craik-Leibovich approximation are</p><p class="math-container">\[    \partial_t \bm{u} = - \left ( \bm{u} \bm{\cdot} \bm{\nabla} \right ) \bm{u}
                        - \left ( \bm{U} \bm{\cdot} \bm{\nabla} \right ) \bm{u}
                        - \left ( \bm{u} \bm{\cdot} \bm{\nabla} \right ) \bm{U}
                        - \left ( \bm{f} - \bm{\nabla} \times \bm{u}^S \right ) \times \bm{u}
                        - \bm{\nabla} \phi
                        + b \bm{\hat z}
                        - \bm{\nabla} \bm{\cdot} \bm{\tau}
                        + \partial_t \bm{u}^S
                        + \bm{F_u} \, ,
    \tag{eq:momentum}\]</p><p>where <span>$b$</span> is buoyancy, <span>$\bm{\tau}$</span> is the kinematic stress tensor, <span>$\bm{F_u}$</span> denotes an internal forcing of the velocity field <span>$\bm{u}$</span>, <span>$\phi$</span> is the potential associated with kinematic and constant hydrostatic contributions to pressure, <span>$\bm{u}^S$</span> is the &#39;Stokes drift&#39; velocity field associated with surface gravity waves, and <span>$\bm{f}$</span> is <em>Coriolis parameter</em>, or the background vorticity associated with the specified rate of rotation of the frame of reference.</p><p>From left to right, the terms that appear on the right-hand side of the momentum conservation equation are:</p><ul><li>momentum advection, <span>$\left ( \bm{u} \bm{\cdot} \bm{\nabla} \right ) \bm{u}$</span>,</li><li>advection of resolved momentum by the background velocity field <span>$\bm{U}$</span>, <span>$\left ( \bm{U} \bm{\cdot} \bm{\nabla} \right ) \bm{u}$</span>,</li><li>advection of background momentum by resolved velocity, <span>$\left ( \bm{u} \bm{\cdot} \bm{\nabla} \right ) \bm{U}$</span>,</li><li>coriolis, <span>$\bm{f} \times \bm{u}$</span></li><li>the effective background rotation rate due to surface waves, <span>$\bm{\nabla} \times \bm{u}^S \right ) \times \bm{u}$</span></li><li>pressure, <span>$\bm{\nabla} \phi$</span>,</li><li>buoyant acceleration, <span>$b \bm{\hat z}$</span></li><li>molecular or turbulence viscous stress, <span>$\bm{\nabla} \bm{\cdot} \bm{\tau}$</span></li><li>a source of momentum due to forcing or damping of surface waves, <span>$\partial_t \bm{u}^S$</span></li><li>an arbitrary internal source of momentum, <span>$\bm{F_u}$</span></li></ul><h2 id="The-tracer-conservation-equation"><a class="docs-heading-anchor" href="#The-tracer-conservation-equation">The tracer conservation equation</a><a id="The-tracer-conservation-equation-1"></a><a class="docs-heading-anchor-permalink" href="#The-tracer-conservation-equation" title="Permalink"></a></h2><p>The conservation law for tracers in Oceananigans.jl is</p><p class="math-container">\[    \partial_t c = - \bm{u} \bm{\cdot} \bm{\nabla} c
                   - \bm{U} \bm{\cdot} \bm{\nabla} c
                   - \bm{u} \bm{\cdot} \bm{\nabla} C
                   - \bm{\nabla} \bm{\cdot} \bm{q}_c
                   + F_c \, ,
    \tag{eq:tracer}\]</p><p>where <span>$\bm{q}_c$</span> is the diffusive flux of <span>$c$</span> and <span>$F_c$</span> is an arbitrary source term. Oceananigans.jl permits arbitrary tracers and thus an arbitrary number of tracer equations to be solved simultaneously with the momentum equations.</p><p>From left to right, the terms that appear on the right-hand side of the tracer conservation equation are</p><ul><li>tracer advection, <span>$\bm{u} \bm{\cdot} \bm{\nabla} c$</span></li><li>tracer advection by the background velocity field, <span>$U$</span>, <span>$\bm{U} \bm{\cdot} \bm{\nabla} c$</span></li><li>advection of the background tracer field, <span>$C$</span>, by the resolved velocity field, <span>$\bm{u} \bm{\cdot} \bm{\nabla} C$</span></li><li>molecular or turbulent diffusion, <span>$\bm{\nabla} \bm{\cdot} \bm{q}_c$</span></li><li>an arbitrary internal source of tracer, <span>$F_c$</span></li></ul><p>The following subsections provide more details on the possible forms that each individual term in the momentum and tracer equations can take in Oceananigans.jl.</p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>Named after Boussinesq (1903) although used earlier by Oberbeck (1879), the Boussinesq   approximation neglects density differences in the momentum equation except when associated   with the gravitational term. It is an accurate approximation for many flows, and especially   so for oceanic flows where density differences are very small. See Vallis (2017, section 2.4)   for an oceanographic introduction to the Boussinesq equations and Vallis (2017, Section 2.A)   for an asymptotic derivation. See Kundu (2015, Section 4.9) for an engineering   introduction.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../model_setup/setting_initial_conditions/">« Setting initial conditions</a><a class="docs-footer-nextpage" href="../coriolis_forces/">Coriolis forces »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 22 February 2021 12:09">Monday 22 February 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
