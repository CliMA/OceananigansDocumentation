<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Turbulence closures · Oceananigans.jl</title><link rel="canonical" href="https://clima.github.io/OceananigansDocumentation/stable/physics/turbulence_closures/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Oceananigans.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../installation_instructions/">Installation instructions</a></li><li><a class="tocitem" href="../../using_gpus/">Using GPUs</a></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/one_dimensional_diffusion/">One-dimensional diffusion</a></li><li><a class="tocitem" href="../../generated/geostrophic_adjustment/">Geostrophic adjustment</a></li><li><a class="tocitem" href="../../generated/two_dimensional_turbulence/">Two-dimensional turbulence</a></li><li><a class="tocitem" href="../../generated/internal_wave/">Internal wave</a></li><li><a class="tocitem" href="../../generated/convecting_plankton/">Convecting plankton</a></li><li><a class="tocitem" href="../../generated/ocean_wind_mixing_and_convection/">Ocean wind mixing and convection</a></li><li><a class="tocitem" href="../../generated/langmuir_turbulence/">Langmuir turbulence</a></li><li><a class="tocitem" href="../../generated/eady_turbulence/">Eady turbulence</a></li><li><a class="tocitem" href="../../generated/kelvin_helmholtz_instability/">Kelvin-Helmholtz instability</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Model setup</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_setup/overview/">Overview</a></li><li><a class="tocitem" href="../../model_setup/architecture/">Architecture</a></li><li><a class="tocitem" href="../../model_setup/number_type/">Number type</a></li><li><a class="tocitem" href="../../model_setup/grids/">Grid</a></li><li><a class="tocitem" href="../../model_setup/clock/">Clock</a></li><li><a class="tocitem" href="../../model_setup/coriolis/">Coriolis (rotation)</a></li><li><a class="tocitem" href="../../model_setup/tracers/">Tracers</a></li><li><a class="tocitem" href="../../model_setup/buoyancy_and_equation_of_state/">Buoyancy and equation of state</a></li><li><a class="tocitem" href="../../model_setup/boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../../model_setup/forcing_functions/">Forcing functions</a></li><li><a class="tocitem" href="../../model_setup/background_fields/">Background fields</a></li><li><a class="tocitem" href="../../model_setup/turbulent_diffusivity_closures_and_les_models/">Turbulent diffusivity closures and LES models</a></li><li><a class="tocitem" href="../../model_setup/lagrangian_particles/">Lagrangian particles</a></li><li><a class="tocitem" href="../../model_setup/diagnostics/">Diagnostics</a></li><li><a class="tocitem" href="../../model_setup/output_writers/">Output writers</a></li><li><a class="tocitem" href="../../model_setup/checkpointing/">Checkpointing</a></li><li><a class="tocitem" href="../../model_setup/setting_initial_conditions/">Setting initial conditions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox" checked/><label class="tocitem" for="menuitem-6"><span class="docs-label">Physics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../navier_stokes_and_tracer_conservation/">Navier-Stokes and tracer conservation equations</a></li><li><a class="tocitem" href="../coriolis_forces/">Coriolis forces</a></li><li><a class="tocitem" href="../buoyancy_and_equations_of_state/">Buoyancy model and equations of state</a></li><li class="is-active"><a class="tocitem" href>Turbulence closures</a><ul class="internal"><li><a class="tocitem" href="#Constant-isotropic-diffusivity"><span>Constant isotropic diffusivity</span></a></li><li><a class="tocitem" href="#Constant-anisotropic-diffusivity"><span>Constant anisotropic diffusivity</span></a></li><li><a class="tocitem" href="#Constant-anisotropic-biharmonic-diffusivity"><span>Constant anisotropic biharmonic diffusivity</span></a></li><li><a class="tocitem" href="#Smagorinsky-Lilly-turbulence-closure"><span>Smagorinsky-Lilly turbulence closure</span></a></li><li><a class="tocitem" href="#Anisotropic-minimum-dissipation-(AMD)-turbulence-closure"><span>Anisotropic minimum dissipation (AMD) turbulence closure</span></a></li></ul></li><li><a class="tocitem" href="../surface_gravity_waves/">Surface gravity waves and the Craik-Leibovich approximation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Numerical implementation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../numerical_implementation/pressure_decomposition/">Pressure decomposition</a></li><li><a class="tocitem" href="../../numerical_implementation/time_stepping/">Time stepping</a></li><li><a class="tocitem" href="../../numerical_implementation/finite_volume/">Finite volume method</a></li><li><a class="tocitem" href="../../numerical_implementation/spatial_operators/">Spatial operators</a></li><li><a class="tocitem" href="../../numerical_implementation/boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../../numerical_implementation/poisson_solvers/">Poisson solvers</a></li><li><a class="tocitem" href="../../numerical_implementation/large_eddy_simulation/">Large eddy simulation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Validation experiments</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../validation/convergence_tests/">Convergence tests</a></li><li><a class="tocitem" href="../../validation/lid_driven_cavity/">Lid-driven cavity</a></li><li><a class="tocitem" href="../../validation/stratified_couette_flow/">Stratified Couette flow</a></li></ul></li><li><a class="tocitem" href="../../gallery/">Gallery</a></li><li><a class="tocitem" href="../../benchmarks/">Performance benchmarks</a></li><li><a class="tocitem" href="../../contributing/">Contributor&#39;s guide</a></li><li><input class="collapse-toggle" id="menuitem-12" type="checkbox"/><label class="tocitem" for="menuitem-12"><span class="docs-label">Appendix</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../appendix/staggered_grid/">Staggered grid</a></li><li><a class="tocitem" href="../../appendix/fractional_step/">Fractional step method</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li><li><a class="tocitem" href="../../library/">Library</a></li><li><a class="tocitem" href="../../function_index/">Function index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Physics</a></li><li class="is-active"><a href>Turbulence closures</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Turbulence closures</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/CliMA/Oceananigans.jl/blob/master/docs/src/physics/turbulence_closures.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Turbulence-closures"><a class="docs-heading-anchor" href="#Turbulence-closures">Turbulence closures</a><a id="Turbulence-closures-1"></a><a class="docs-heading-anchor-permalink" href="#Turbulence-closures" title="Permalink"></a></h1><p>The turbulence closure selected by the user determines the form of stress divergence <span>$\bm{\nabla} \bm{\cdot} \bm{\tau}$</span> and diffusive flux divergence <span>$\bm{\nabla} \bm{\cdot} \bm{q}_c$</span> in the momentum and tracer conservation equations.</p><h2 id="Constant-isotropic-diffusivity"><a class="docs-heading-anchor" href="#Constant-isotropic-diffusivity">Constant isotropic diffusivity</a><a id="Constant-isotropic-diffusivity-1"></a><a class="docs-heading-anchor-permalink" href="#Constant-isotropic-diffusivity" title="Permalink"></a></h2><p>In a constant isotropic diffusivity model, the kinematic stress tensor is defined</p><p class="math-container">\[\tau_{ij} = - \nu \Sigma_{ij} \, ,\]</p><p>where <span>$\nu$</span> is a constant viscosity and <span>$\Sigma_{ij} \equiv \tfrac{1}{2} \left ( u_{i, j} + u_{j, i} \right )$</span> is the strain-rate tensor. The divergence of <span>$\bm{\tau}$</span> is then</p><p class="math-container">\[\bm{\nabla} \bm{\cdot} \bm{\tau} = -\nu \bm{\nabla}^2 \bm{u} \, .\]</p><p>Similarly, the diffusive tracer flux is <span>$\bm{q}_c = - \kappa \bm{\nabla} c$</span> for tracer diffusivity <span>$\kappa$</span>, and the diffusive tracer flux divergence is</p><p class="math-container">\[\bm{\nabla} \bm{\cdot} \bm{q}_c = - \kappa \bm{\nabla}^2 c \, .\]</p><p>Each tracer may have a unique diffusivity <span>$\kappa$</span>.</p><h2 id="Constant-anisotropic-diffusivity"><a class="docs-heading-anchor" href="#Constant-anisotropic-diffusivity">Constant anisotropic diffusivity</a><a id="Constant-anisotropic-diffusivity-1"></a><a class="docs-heading-anchor-permalink" href="#Constant-anisotropic-diffusivity" title="Permalink"></a></h2><p>In Oceananigans.jl, a constant anisotropic diffusivity implies a constant tensor diffusivity <span>$\nu_{j k}$</span> and stress <span>$\bm{\tau}_{ij} = \nu_{j k} u_{i, k}$</span> with non-zero components <span>$\nu_{11} = \nu_{22} = \nu_h$</span> and <span>$\nu_{33} = \nu_v$</span>. With this form the kinematic stress divergence becomes</p><p class="math-container">\[\bm{\nabla} \bm{\cdot} \bm{\tau} = - \left [ \nu_h \left ( \partial_x^2 + \partial_y^2 \right )
                                    + \nu_v \partial_z^2 \right ] \bm{u} \, ,\]</p><p>and diffusive flux divergence</p><p class="math-container">\[\bm{\nabla} \bm{\cdot} \bm{q}_c = - \left [ \kappa_{h} \left ( \partial_x^2 + \partial_y^2 \right )
                                    + \kappa_{v} \partial_z^2 \right ] c \, .\]</p><p>in terms of the horizontal viscosities and diffusivities <span>$\nu_h$</span> and <span>$\kappa_{h}$</span> and the vertical viscosity and diffusivities <span>$\nu_v$</span> and <span>$\kappa_{v}$</span>. Each tracer may have a unique diffusivity components <span>$\kappa_h$</span> and <span>$\kappa_v$</span>.</p><h2 id="Constant-anisotropic-biharmonic-diffusivity"><a class="docs-heading-anchor" href="#Constant-anisotropic-biharmonic-diffusivity">Constant anisotropic biharmonic diffusivity</a><a id="Constant-anisotropic-biharmonic-diffusivity-1"></a><a class="docs-heading-anchor-permalink" href="#Constant-anisotropic-biharmonic-diffusivity" title="Permalink"></a></h2><p>In Oceananigans.jl, a constant anisotropic biharmonic diffusivity implies a constant tensor diffusivity <span>$\nu_{j k}$</span> and stress <span>$\bm{\tau}_{ij} = \nu_{j k} \partial_k^3 u_i$</span> with non-zero components <span>$\nu_{11} = \nu_{22} = \nu_h$</span> and <span>$\nu_{33} = \nu_v$</span>. With this form the kinematic stress divergence becomes</p><p class="math-container">\[\bm{\nabla} \bm{\cdot} \bm{\tau} = - \left [ \nu_h \left ( \partial_x^2 + \partial_y^2 \right )^2
                                    + \nu_v \partial_z^4 \right ] \bm{u} \, ,\]</p><p>and diffusive flux divergence</p><p class="math-container">\[\bm{\nabla} \bm{\cdot} \bm{q}_c = - \left [ \kappa_{h} \left ( \partial_x^2 + \partial_y^2 \right )^2
                                    + \kappa_{v} \partial_z^4 \right ] c \, .\]</p><p>in terms of the horizontal biharmonic viscosities and diffusivities <span>$\nu_h$</span> and <span>$\kappa_{h}$</span> and the vertical biharmonic viscosity and diffusivities <span>$\nu_v$</span> and <span>$\kappa_{v}$</span>. Each tracer may have a unique diffusivity components <span>$\kappa_h$</span> and <span>$\kappa_v$</span>.</p><h2 id="Smagorinsky-Lilly-turbulence-closure"><a class="docs-heading-anchor" href="#Smagorinsky-Lilly-turbulence-closure">Smagorinsky-Lilly turbulence closure</a><a id="Smagorinsky-Lilly-turbulence-closure-1"></a><a class="docs-heading-anchor-permalink" href="#Smagorinsky-Lilly-turbulence-closure" title="Permalink"></a></h2><p>In the turbulence closure proposed by Lilly (1962) and Smagorinsky (1963), the subgrid stress associated with unresolved turbulent motions is modeled diffusively via</p><p class="math-container">\[\tau_{ij} = \nu_e \Sigma_{ij} \, ,\]</p><p>where <span>$\Sigma_{ij} = \tfrac{1}{2} \left ( u_{i, j} + u_{j, i} \right )$</span> is the resolved strain rate. The eddy viscosity is given by</p><p class="math-container">\[    \nu_e = \left ( C \Delta_f \right )^2 \sqrt{ \Sigma^2 } \, \Upsilon(Ri) + \nu \, ,
    \tag{eq:smagorinsky-viscosity}\]</p><p>where <span>$\Delta_f$</span> is the &quot;filter width&quot; associated with the finite volume grid spacing, <span>$C$</span> is a user-specified model constant, <span>$\Sigma^2 \equiv \Sigma_{ij} \Sigma{ij}$</span>, and <span>$\nu$</span> is a constant isotropic background viscosity. The factor <span>$\Upsilon(Ri)$</span> reduces <span>$\nu_e$</span> in regions of strong stratification where the resolved gradient Richardson number <span>$Ri \equiv N^2 / \Sigma^2$</span> is large via</p><p class="math-container">\[    \Upsilon(Ri) = \sqrt{1 - \min \left ( 1, C_b N^2 / \Sigma^2 \right )} \, ,\]</p><p>where <span>$N^2 = \max \left (0, \partial_z b \right )$</span> is the squared buoyancy frequency for stable stratification with <span>$\partial_z b &gt; 0$</span> and <span>$C_b$</span> is a user-specified constant. Roughly speaking, the filter width for the Smagorinsky-Lilly closure is taken as</p><p class="math-container">\[\Delta_f(\bm{x}) = \left ( \Delta x \Delta y \Delta z \right)^{1/3} \, ,\]</p><p>where <span>$\Delta x$</span>, <span>$\Delta y$</span>, and <span>$\Delta z$</span> are the grid spacing in the <span>$\bm{\hat x}$</span>, <span>$\bm{\hat y}$</span>, and <span>$\bm{\hat z}$</span> directions at location <span>$\bm{x} = (x, y, z)$</span>.</p><p>The effect of subgrid turbulence on tracer mixing is also modeled diffusively via</p><p class="math-container">\[\bm{q}_c = \kappa_e \bm{\nabla} c \, ,\]</p><p>where the eddy diffusivity <span>$\kappa_e$</span> is</p><p class="math-container">\[\kappa_e = \frac{\nu_e - \nu}{Pr} + \kappa \, ,\]</p><p>where <span>$Pr$</span> is a turbulent Prandtl number and <span>$\kappa$</span> is a constant isotropic background diffusivity. Both <span>$Pr$</span> and <span>$\kappa$</span> may be set independently for each tracer.</p><h2 id="Anisotropic-minimum-dissipation-(AMD)-turbulence-closure"><a class="docs-heading-anchor" href="#Anisotropic-minimum-dissipation-(AMD)-turbulence-closure">Anisotropic minimum dissipation (AMD) turbulence closure</a><a id="Anisotropic-minimum-dissipation-(AMD)-turbulence-closure-1"></a><a class="docs-heading-anchor-permalink" href="#Anisotropic-minimum-dissipation-(AMD)-turbulence-closure" title="Permalink"></a></h2><p>Oceananigans.jl uses the anisotropic minimum dissipation (AMD) model proposed by Verstappen18 and described and tested by Vreugdenhil18. The AMD model uses an eddy diffusivity hypothesis similar the Smagorinsky-Lilly model. In the AMD model, the eddy viscosity and diffusivity for each tracer are defined in terms of eddy viscosity and diffusivity <em>predictors</em> <span>$\nu_e^\dagger$</span> and <span>$\kappa_e^\dagger$</span>, such that</p><p class="math-container">\[    \nu_e = \max \left ( 0, \nu_e^\dagger \right ) + \nu
    \quad \text{and} \quad
    \kappa_e = \max \left ( 0, \kappa_e^\dagger \right ) + \kappa \, ,\]</p><p>to ensure that <span>$\nu_e \ge 0$</span> and <span>$\kappa_e \ge 0$</span>, where <span>$\nu$</span> and <span>$\kappa$</span> are the constant isotropic background viscosity and diffusivities for each tracer. The eddy viscosity predictor is</p><p class="math-container">\[    \tag{eq:nu-dagger}
    \nu_e^\dagger = -(C \Delta_f)^2
    \frac
        {\left( \hat{\partial}_k \hat{u}_i \right) \left( \hat{\partial}_k \hat{u}_j \right) \hat{\Sigma}_{ij}
        + C_b \hat{\delta}_{i3} \left( \hat{\partial}_k \hat{u_i} \right) \hat{\partial}_k b}
        {\left( \hat{\partial}_l \hat{u}_m \right) \left( \hat{\partial}_l \hat{u}_m \right)}\]</p><p>while the eddy diffusivity predictor for tracer <span>$c$</span> is</p><p class="math-container">\[    \tag{eq:kappa-dagger}
    \kappa_e^\dagger = -(C \Delta_f)^2
    \frac
        {\left( \hat{\partial}_k \hat{u}_i \right) \left( \hat{\partial}_k c \right) \hat{\partial}_i c}
        {\left( \hat{\partial}_l c \right) \left( \hat{\partial}_l c \right)} \, .\]</p><p>In the definitions of the eddy viscosity and eddy diffusivity predictor, <span>$C$</span> and <span>$C_b$</span> are user-specified model constants, <span>$\Delta_f$</span> is a &quot;filter width&quot; associated with the finite volume grid spacing, and the hat decorators on partial derivatives, velocities, and the Kronecker delta <span>$\hat \delta_{i3}$</span> are defined such that</p><p class="math-container">\[    \hat \partial_i \equiv \Delta_i \partial_i, \qquad
    \hat{u}_i(x, t) \equiv \frac{u_i(x, t)}{\Delta_i}, \quad \text{and} \quad
    \hat{\delta}_{i3} \equiv \frac{\delta_{i3}}{\Delta_3} \, .\]</p><p>A velocity gradient, for example, is therefore <span>$\hat{\partial}_i \hat{u}_j(x, t) = \frac{\Delta_i}{\Delta_j} \partial_i u_j(x, t)$</span>, while the normalized strain tensor is</p><p class="math-container">\[    \hat{\Sigma}_{ij} =
        \frac{1}{2} \left[ \hat{\partial}_i \hat{u}_j(x, t) + \hat{\partial}_j \hat{u}_i(x, t) \right] \, .\]</p><p>The filter width <span>$\Delta_f$</span> in that appears in the viscosity and diffusivity predictors is taken as the square root of the harmonic mean of the squares of the filter widths in each direction:</p><p class="math-container">\[    \frac{1}{\Delta_f^2} = \frac{1}{3} \left(   \frac{1}{\Delta x^2}
                                              + \frac{1}{\Delta y^2}
                                              + \frac{1}{\Delta z^2} \right) \, .\]</p><p>The constant <span>$C_b$</span> permits the &quot;buoyancy modification&quot; term it multiplies to be omitted from a calculation. By default we use the model constants <span>$C=1/12$</span> and <span>$C_b=0$</span>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../buoyancy_and_equations_of_state/">« Buoyancy model and equations of state</a><a class="docs-footer-nextpage" href="../surface_gravity_waves/">Surface gravity waves and the Craik-Leibovich approximation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 4 March 2021 13:46">Thursday 4 March 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
