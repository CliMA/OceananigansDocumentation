<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Turbulence closures · Oceananigans.jl</title><meta name="title" content="Turbulence closures · Oceananigans.jl"/><meta property="og:title" content="Turbulence closures · Oceananigans.jl"/><meta property="twitter:title" content="Turbulence closures · Oceananigans.jl"/><meta name="description" content="Documentation for Oceananigans.jl."/><meta property="og:description" content="Documentation for Oceananigans.jl."/><meta property="twitter:description" content="Documentation for Oceananigans.jl."/><meta property="og:url" content="https://clima.github.io/OceananigansDocumentation/stable/models/turbulence_closures/"/><meta property="twitter:url" content="https://clima.github.io/OceananigansDocumentation/stable/models/turbulence_closures/"/><link rel="canonical" href="https://clima.github.io/OceananigansDocumentation/stable/models/turbulence_closures/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Oceananigans.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../quick_start/">Quick start</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../literated/one_dimensional_diffusion/">One-dimensional diffusion</a></li><li><a class="tocitem" href="../../literated/two_dimensional_turbulence/">Two-dimensional turbulence</a></li><li><a class="tocitem" href="../../literated/internal_wave/">Internal wave</a></li><li><a class="tocitem" href="../../literated/internal_tide/">Internal tide by a seamount</a></li><li><a class="tocitem" href="../../literated/convecting_plankton/">Convecting plankton</a></li><li><a class="tocitem" href="../../literated/ocean_wind_mixing_and_convection/">Ocean wind mixing and convection</a></li><li><a class="tocitem" href="../../literated/langmuir_turbulence/">Langmuir turbulence</a></li><li><a class="tocitem" href="../../literated/baroclinic_adjustment/">Baroclinic adjustment</a></li><li><a class="tocitem" href="../../literated/kelvin_helmholtz_instability/">Kelvin-Helmholtz instability</a></li><li><a class="tocitem" href="../../literated/shallow_water_Bickley_jet/">Shallow water Bickley jet</a></li><li><a class="tocitem" href="../../literated/horizontal_convection/">Horizontal convection</a></li><li><a class="tocitem" href="../../literated/tilted_bottom_boundary_layer/">Tilted bottom boundary layer</a></li></ul></li><li><a class="tocitem" href="../../grids/">Grids</a></li><li><a class="tocitem" href="../../fields/">Fields</a></li><li><a class="tocitem" href="../../operations/">Operations</a></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox" checked/><label class="tocitem" for="menuitem-7"><span class="docs-label">Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../models_overview/">Overview</a></li><li><a class="tocitem" href="../coriolis/">Coriolis forces</a></li><li><a class="tocitem" href="../buoyancy_and_equation_of_state/">Buoyancy and equations of state</a></li><li class="is-active"><a class="tocitem" href>Turbulence closures</a><ul class="internal"><li><a class="tocitem" href="#Closures-for-large-eddy-simulation"><span>Closures for large eddy simulation</span></a></li><li><a class="tocitem" href="#Closures-for-hydrostatic-modeling"><span>Closures for hydrostatic modeling</span></a></li></ul></li><li><a class="tocitem" href="../boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../forcing_functions/">Forcings</a></li><li><a class="tocitem" href="../lagrangian_particles/">Lagrangian particles</a></li><li><a class="tocitem" href="../background_fields/">Background fields</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../simulations/simulations_overview/">Overview</a></li><li><a class="tocitem" href="../../simulations/schedules/">Schedules</a></li><li><a class="tocitem" href="../../simulations/output_writers/">Output writers</a></li><li><a class="tocitem" href="../../simulations/checkpointing/">Checkpointing</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9" type="checkbox"/><label class="tocitem" for="menuitem-9"><span class="docs-label">Physics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../physics/notation/">Coordinate system and notation</a></li><li><a class="tocitem" href="../../physics/boussinesq/">Boussinesq approximation</a></li><li><input class="collapse-toggle" id="menuitem-9-3" type="checkbox"/><label class="tocitem" for="menuitem-9-3"><span class="docs-label"><code>NonhydrostaticModel</code></span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../physics/nonhydrostatic_model/">Nonhydrostatic model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9-4" type="checkbox"/><label class="tocitem" for="menuitem-9-4"><span class="docs-label"><code>HydrostaticFreeSurfaceModel</code></span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../physics/hydrostatic_free_surface_model/">Hydrostatic model with a free surface</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9-5" type="checkbox"/><label class="tocitem" for="menuitem-9-5"><span class="docs-label"><code>ShallowWaterModel</code></span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../physics/shallow_water_model/">Shallow water model</a></li></ul></li><li><a class="tocitem" href="../../physics/boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../../physics/buoyancy_and_equations_of_state/">Buoyancy models and equations of state</a></li><li><a class="tocitem" href="../../physics/coriolis_forces/">Coriolis forces</a></li><li><a class="tocitem" href="../../physics/turbulence_closures/">Turbulence closures</a></li><li><a class="tocitem" href="../../physics/surface_gravity_waves/">Surface gravity waves and the Craik-Leibovich approximation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">Numerical implementation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../numerical_implementation/finite_volume/">Finite volume method</a></li><li><a class="tocitem" href="../../numerical_implementation/spatial_operators/">Spatial operators</a></li><li><a class="tocitem" href="../../numerical_implementation/generalized_vertical_coordinates/">Generalized vertical coordinates</a></li><li><a class="tocitem" href="../../numerical_implementation/pressure_decomposition/">Pressure decomposition</a></li><li><a class="tocitem" href="../../numerical_implementation/time_stepping/">Time stepping</a></li><li><a class="tocitem" href="../../numerical_implementation/boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../../numerical_implementation/elliptic_solvers/">Elliptic solvers</a></li><li><a class="tocitem" href="../../numerical_implementation/large_eddy_simulation/">Large eddy simulation</a></li></ul></li><li><a class="tocitem" href="../../simulation_tips/">Simulation tips</a></li><li><a class="tocitem" href="../../contributing/">Contributor&#39;s guide</a></li><li><a class="tocitem" href="../../gallery/">Gallery</a></li><li><a class="tocitem" href="../../references/">References</a></li><li><input class="collapse-toggle" id="menuitem-15" type="checkbox"/><label class="tocitem" for="menuitem-15"><span class="docs-label">Appendix</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../appendix/staggered_grid/">Staggered grid</a></li><li><a class="tocitem" href="../../appendix/fractional_step/">Fractional step method</a></li><li><a class="tocitem" href="../../appendix/convergence_tests/">Convergence tests</a></li><li><a class="tocitem" href="../../appendix/benchmarks/">Performance benchmarks</a></li><li><a class="tocitem" href="../../appendix/library/">Library</a></li><li><a class="tocitem" href="../../appendix/function_index/">Function index</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Models</a></li><li class="is-active"><a href>Turbulence closures</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Turbulence closures</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/Oceananigans.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/Oceananigans.jl/blob/main/docs/src/models/turbulence_closures.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="turbulence_closures"><a class="docs-heading-anchor" href="#turbulence_closures">Turbulence closures, viscosities, and diffusivities</a><a id="turbulence_closures-1"></a><a class="docs-heading-anchor-permalink" href="#turbulence_closures" title="Permalink"></a></h1><p>When a turbulence closure is added to the constructor of either <a href="../models_overview/#Oceananigans.Models.NonhydrostaticModels.NonhydrostaticModel"><code>NonhydrostaticModel</code></a> or <a href="../models_overview/#Oceananigans.Models.HydrostaticFreeSurfaceModels.HydrostaticFreeSurfaceModel"><code>HydrostaticFreeSurfaceModel</code></a> via the keyword argument <code>closure</code>, it contributes a diffusive flux divergence to the tendency of momentum and tracer equations, and typically represents the effects of turbulent processes that are not explicitly resolved. Turbulence closures can also represent molecular viscosity and diffusion of heat, salt, or other tracers.</p><p>Below we detail available options for turbulence closures. A <code>tuple</code> of closures can be used to represent multiple closures added together.</p><h3 id="Scalar-diffusivity"><a class="docs-heading-anchor" href="#Scalar-diffusivity">Scalar diffusivity</a><a id="Scalar-diffusivity-1"></a><a class="docs-heading-anchor-permalink" href="#Scalar-diffusivity" title="Permalink"></a></h3><p>To use constant isotropic values for the viscosity <span>$\nu$</span> and diffusivity <span>$\kappa$</span>, use <a href="../../appendix/library/#Oceananigans.TurbulenceClosures.ScalarDiffusivity"><code>ScalarDiffusivity</code></a>:</p><pre><code class="language-julia-repl hljs">julia&gt; using Oceananigans

julia&gt; closure = ScalarDiffusivity(ν=1e-2, κ=1e-2)
ScalarDiffusivity{ExplicitTimeDiscretization}(ν=0.01, κ=0.01)</code></pre><p>To specify constant values for the horizontal and vertical viscosities, <span>$\nu_h$</span> and <span>$\nu_z$</span>, and horizontal and vertical diffusivities, <span>$\kappa_h$</span> and <span>$\kappa_z$</span>, use <a href="../../appendix/library/#Oceananigans.TurbulenceClosures.HorizontalScalarDiffusivity"><code>HorizontalScalarDiffusivity</code></a> and <a href="../../appendix/library/#Oceananigans.TurbulenceClosures.VerticalScalarDiffusivity"><code>VerticalScalarDiffusivity</code></a>:</p><pre><code class="language-julia-repl hljs">julia&gt; using Oceananigans

julia&gt; horizontal_closure = HorizontalScalarDiffusivity(ν=1e-3, κ=2e-3)
HorizontalScalarDiffusivity{ExplicitTimeDiscretization}(ν=0.001, κ=0.002)

julia&gt; vertical_closure = VerticalScalarDiffusivity(ν=1e-3, κ=2e-3)
VerticalScalarDiffusivity{ExplicitTimeDiscretization}(ν=0.001, κ=0.002)</code></pre><h4 id="Tracer-specific-diffusivities"><a class="docs-heading-anchor" href="#Tracer-specific-diffusivities">Tracer-specific diffusivities</a><a id="Tracer-specific-diffusivities-1"></a><a class="docs-heading-anchor-permalink" href="#Tracer-specific-diffusivities" title="Permalink"></a></h4><p>Different diffusivities for each tracer can be set by passing a <code>NamedTuple</code> for <span>$\kappa$</span>:</p><pre><code class="language-julia-repl hljs">julia&gt; using Oceananigans

julia&gt; ScalarDiffusivity(ν=1e-6, κ=(S=1e-7, T=1e-10))
ScalarDiffusivity{ExplicitTimeDiscretization}(ν=1.0e-6, κ=(S=1.0e-7, T=1.0e-10))</code></pre><p>The above sets a viscosity of <code>1e-6</code>, and diffusivities for tracers <code>T</code> and <code>S</code> of <code>1e-7</code> and <code>1e-10</code> respectively. This method is valid for all scalar diffusivity closures. This pattern of <code>NamedTuple</code> for tracer-specific values is used in other closures as well.</p><h3 id="Biharmonic-diffusivity"><a class="docs-heading-anchor" href="#Biharmonic-diffusivity">Biharmonic diffusivity</a><a id="Biharmonic-diffusivity-1"></a><a class="docs-heading-anchor-permalink" href="#Biharmonic-diffusivity" title="Permalink"></a></h3><p>For biharmonic (fourth-order) diffusivity, use <a href="../../appendix/library/#Oceananigans.TurbulenceClosures.ScalarBiharmonicDiffusivity"><code>ScalarBiharmonicDiffusivity</code></a>, <a href="@ref"><code>HorizontalScalarBiharmonicDiffusivity</code></a>, or <a href="@ref"><code>VerticalScalarBiharmonicDiffusivity</code></a>:</p><pre><code class="language-julia-repl hljs">julia&gt; using Oceananigans

julia&gt; closure = HorizontalScalarBiharmonicDiffusivity(ν=1e8, κ=1e8)
ScalarBiharmonicDiffusivity{HorizontalFormulation}(ν=1.0e8, κ=1.0e8)</code></pre><h4 id="Discrete-diffusivity-functions"><a class="docs-heading-anchor" href="#Discrete-diffusivity-functions">Discrete diffusivity functions</a><a id="Discrete-diffusivity-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-diffusivity-functions" title="Permalink"></a></h4><p>Viscosity or diffusivity can be specified as a discrete function of grid indices and model state. This is useful for resolution-dependent coefficients. For example, we can set <span>$\nu = A^2 / \lambda$</span>, where <span>$A$</span> is the grid cell area and <span>$\lambda$</span> is a damping timescale:</p><pre><code class="language-julia-repl hljs">julia&gt; using Oceananigans, Oceananigans.Units

julia&gt; @inline νhb(i, j, k, grid, ℓx, ℓy, ℓz, clock, fields, λ) =
           Oceananigans.Operators.Az(i, j, k, grid, ℓx, ℓy, ℓz)^2 / λ
νhb (generic function with 1 method)

julia&gt; closure = HorizontalScalarBiharmonicDiffusivity(ν=νhb, discrete_form=true, parameters=15days)
ScalarBiharmonicDiffusivity{HorizontalFormulation}(ν=Oceananigans.TurbulenceClosures.DiscreteDiffusionFunction{Nothing, Nothing, Nothing, Float64, typeof(νhb)}, κ=0.0)</code></pre><p>The <code>ℓx</code>, <code>ℓy</code>, <code>ℓz</code> arguments indicate the grid location (<code>Center()</code> or <code>Face()</code>) where the diffusivity is evaluated.</p><h3 id="Tupled-closures"><a class="docs-heading-anchor" href="#Tupled-closures">Tupled closures</a><a id="Tupled-closures-1"></a><a class="docs-heading-anchor-permalink" href="#Tupled-closures" title="Permalink"></a></h3><p>Multiple closures can be combined in a tuple. All closure contributions are summed:</p><pre><code class="language-julia-repl hljs">julia&gt; using Oceananigans

julia&gt; closure = (HorizontalScalarDiffusivity(ν=1e-3), VerticalScalarDiffusivity(ν=1e-4))
(HorizontalScalarDiffusivity{ExplicitTimeDiscretization}(ν=0.001, κ=0.0), VerticalScalarDiffusivity{ExplicitTimeDiscretization}(ν=0.0001, κ=0.0))</code></pre><p>See the <a href="#hydrostatic-example">hydrostatic modeling example</a> below for a more complex tuple.</p><h2 id="Closures-for-large-eddy-simulation"><a class="docs-heading-anchor" href="#Closures-for-large-eddy-simulation">Closures for large eddy simulation</a><a id="Closures-for-large-eddy-simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Closures-for-large-eddy-simulation" title="Permalink"></a></h2><p>These closures compute eddy viscosity and diffusivity from resolved flow features for large eddy simulation (LES).</p><h3 id="SmagorinskyLilly"><a class="docs-heading-anchor" href="#SmagorinskyLilly"><code>SmagorinskyLilly</code></a><a id="SmagorinskyLilly-1"></a><a class="docs-heading-anchor-permalink" href="#SmagorinskyLilly" title="Permalink"></a></h3><p><a href="#SmagorinskyLilly"><code>SmagorinskyLilly</code></a> computes an eddy viscosity from the resolved strain rate with a buoyancy-based stability correction, following the classic work of <a href="../../references/#Smagorinsky1958">Smagorinsky (1958)</a>, <a href="../../references/#Smagorinsky63">Smagorinsky (1963)</a>, <a href="../../references/#Lilly62">Lilly (1962)</a>, and <a href="../../references/#Lilly66">Lilly (1966)</a>:</p><pre><code class="language-julia-repl hljs">julia&gt; using Oceananigans

julia&gt; SmagorinskyLilly()
Smagorinsky closure with
├── coefficient = LillyCoefficient(smagorinsky = 0.16, reduction_factor = 1.0)
└── Pr = 1.0</code></pre><h3 id="DynamicSmagorinsky"><a class="docs-heading-anchor" href="#DynamicSmagorinsky"><code>DynamicSmagorinsky</code></a><a id="DynamicSmagorinsky-1"></a><a class="docs-heading-anchor-permalink" href="#DynamicSmagorinsky" title="Permalink"></a></h3><p><a href="#DynamicSmagorinsky"><code>DynamicSmagorinsky</code></a> dynamically computes the Smagorinsky coefficient from the resolved flow, using the scale-invariant procedure described by <a href="../../references/#BouZeid05">Bou-Zeid <em>et al.</em> (2005)</a>. Two averaging methods are available:</p><p><strong>Lagrangian averaging</strong> (default): averages along fluid parcel trajectories:</p><pre><code class="language-julia-repl hljs">julia&gt; using Oceananigans

julia&gt; DynamicSmagorinsky()
DynamicSmagorinsky{Float64}:
├── averaging = Oceananigans.TurbulenceClosures.Smagorinskys.LagrangianAveraging()
├── schedule = IterationInterval(1, 0)
├── Pr = 1.0
└── minimum_numerator = 1.0e-32</code></pre><p><strong>Directional averaging</strong>: averages along specified dimensions, useful for flows with homogeneous directions:</p><pre><code class="language-julia-repl hljs">julia&gt; using Oceananigans

julia&gt; DynamicSmagorinsky(averaging=(1, 2))  # average in x and y
DynamicSmagorinsky{Float64}:
├── averaging = (1, 2)
├── schedule = IterationInterval(1, 0)
├── Pr = 1.0
└── minimum_numerator = 1.0e-32</code></pre><h3 id="AnisotropicMinimumDissipation"><a class="docs-heading-anchor" href="#AnisotropicMinimumDissipation"><code>AnisotropicMinimumDissipation</code></a><a id="AnisotropicMinimumDissipation-1"></a><a class="docs-heading-anchor-permalink" href="#AnisotropicMinimumDissipation" title="Permalink"></a></h3><p><a href="#AnisotropicMinimumDissipation"><code>AnisotropicMinimumDissipation</code></a> is an LES closure based on the minimum dissipation principle, as developed by <a href="../../references/#Verstappen14">Verstappen <em>et al.</em> (2014)</a>, <a href="../../references/#Rozema15">Rozema <em>et al.</em> (2015)</a>, <a href="../../references/#Abkar16">Abkar <em>et al.</em> (2016)</a>, and <a href="../../references/#Verstappen18">Verstappen (2018)</a>:</p><pre><code class="language-julia-repl hljs">julia&gt; using Oceananigans

julia&gt; AnisotropicMinimumDissipation()
AnisotropicMinimumDissipation{ExplicitTimeDiscretization} turbulence closure with:
           Poincaré constant for momentum eddy viscosity Cν: 0.3333333333333333
    Poincaré constant for tracer(s) eddy diffusivit(ies) Cκ: 0.3333333333333333
                        Buoyancy modification multiplier Cb: nothing</code></pre><h2 id="Closures-for-hydrostatic-modeling"><a class="docs-heading-anchor" href="#Closures-for-hydrostatic-modeling">Closures for hydrostatic modeling</a><a id="Closures-for-hydrostatic-modeling-1"></a><a class="docs-heading-anchor-permalink" href="#Closures-for-hydrostatic-modeling" title="Permalink"></a></h2><p>These closures are designed for hydrostatic models, parameterizing vertical mixing and mesoscale eddies.</p><h3 id="ConvectiveAdjustmentVerticalDiffusivity"><a class="docs-heading-anchor" href="#ConvectiveAdjustmentVerticalDiffusivity"><code>ConvectiveAdjustmentVerticalDiffusivity</code></a><a id="ConvectiveAdjustmentVerticalDiffusivity-1"></a><a class="docs-heading-anchor-permalink" href="#ConvectiveAdjustmentVerticalDiffusivity" title="Permalink"></a></h3><p><a href="#ConvectiveAdjustmentVerticalDiffusivity"><code>ConvectiveAdjustmentVerticalDiffusivity</code></a> applies enhanced vertical diffusivity whenever and wherever the stratification becomes unstable:</p><pre><code class="language-julia-repl hljs">julia&gt; using Oceananigans

julia&gt; ConvectiveAdjustmentVerticalDiffusivity(convective_κz = 1.0, background_κz = 1e-3)
ConvectiveAdjustmentVerticalDiffusivity{VerticallyImplicitTimeDiscretization}(background_κz=0.001 convective_κz=1.0 background_νz=0.0 convective_νz=0.0)</code></pre><h3 id="CATKEVerticalDiffusivity"><a class="docs-heading-anchor" href="#CATKEVerticalDiffusivity"><code>CATKEVerticalDiffusivity</code></a><a id="CATKEVerticalDiffusivity-1"></a><a class="docs-heading-anchor-permalink" href="#CATKEVerticalDiffusivity" title="Permalink"></a></h3><p><a href="#CATKEVerticalDiffusivity"><code>CATKEVerticalDiffusivity</code></a> is a TKE-based closure for vertical mixing by small-scale ocean turbulence, as described by <a href="../../references/#Wagner25catke">Wagner <em>et al.</em> (2025)</a>. It uses a prognostic equation for turbulent kinetic energy (the <code>:e</code> tracer).</p><div class="admonition is-info" id="HydrostaticFreeSurfaceModel-only-4a7e96066225365c"><header class="admonition-header">HydrostaticFreeSurfaceModel only<a class="admonition-anchor" href="#HydrostaticFreeSurfaceModel-only-4a7e96066225365c" title="Permalink"></a></header><div class="admonition-body"><p><code>CATKEVerticalDiffusivity</code> is currently only supported by <code>HydrostaticFreeSurfaceModel</code>.</p></div></div><pre><code class="language-julia-repl hljs">julia&gt; using Oceananigans

julia&gt; CATKEVerticalDiffusivity()
CATKEVerticalDiffusivity{VerticallyImplicitTimeDiscretization}
├── maximum_tracer_diffusivity: Inf
├── maximum_tke_diffusivity: Inf
├── maximum_viscosity: Inf
├── minimum_tke: 1.0e-9
├── negative_tke_time_scale: 60.0
├── minimum_convective_buoyancy_flux: 1.0e-11
├── tke_time_step: Nothing
├── mixing_length: TKEBasedVerticalDiffusivities.CATKEMixingLength
│   ├── Cˢ:   1.131
│   ├── Cᵇ:   0.28
│   ├── Cʰⁱu: 0.242
│   ├── Cʰⁱc: 0.098
│   ├── Cʰⁱe: 0.548
│   ├── Cˡᵒu: 0.361
│   ├── Cˡᵒc: 0.369
│   ├── Cˡᵒe: 7.863
│   ├── Cᵘⁿu: 0.37
│   ├── Cᵘⁿc: 0.572
│   ├── Cᵘⁿe: 1.447
│   ├── Cᶜu:  3.705
│   ├── Cᶜc:  4.793
│   ├── Cᶜe:  3.642
│   ├── Cᵉc:  0.112
│   ├── Cᵉe:  0.0
│   ├── Cˢᵖ:  0.505
│   ├── CRiᵟ: 1.02
│   └── CRi⁰: 0.254
└── turbulent_kinetic_energy_equation: TKEBasedVerticalDiffusivities.CATKEEquation
    ├── CʰⁱD: 0.579
    ├── CˡᵒD: 1.604
    ├── CᵘⁿD: 0.923
    ├── CᶜD:  3.254
    ├── CᵉD:  0.0
    ├── Cᵂu★: 3.179
    ├── CᵂwΔ: 0.383
    └── Cᵂϵ:  1.0</code></pre><h3 id="TKEDissipationVerticalDiffusivity"><a class="docs-heading-anchor" href="#TKEDissipationVerticalDiffusivity"><code>TKEDissipationVerticalDiffusivity</code></a><a id="TKEDissipationVerticalDiffusivity-1"></a><a class="docs-heading-anchor-permalink" href="#TKEDissipationVerticalDiffusivity" title="Permalink"></a></h3><p><a href="#TKEDissipationVerticalDiffusivity"><code>TKEDissipationVerticalDiffusivity</code></a> is a two-equation closure (k-ε) for vertical mixing that uses prognostic equations for both turbulent kinetic energy (<code>:e</code>) and its dissipation rate (<code>:ϵ</code>). For more information about k-ε closures, see <a href="../../references/#burchard2001comparative">Burchard and Bolding (2001)</a>, <a href="../../references/#umlauf2003generic">Umlauf and Burchard (2003)</a>, and <a href="../../references/#umlauf2005second">Umlauf and Burchard (2005)</a>.</p><div class="admonition is-info" id="HydrostaticFreeSurfaceModel-only-c81cef0d7dd16dcd"><header class="admonition-header">HydrostaticFreeSurfaceModel only<a class="admonition-anchor" href="#HydrostaticFreeSurfaceModel-only-c81cef0d7dd16dcd" title="Permalink"></a></header><div class="admonition-body"><p><code>TKEDissipationVerticalDiffusivity</code> is currently only supported by <code>HydrostaticFreeSurfaceModel</code>.</p></div></div><pre><code class="language-julia-repl hljs">julia&gt; using Oceananigans

julia&gt; TKEDissipationVerticalDiffusivity()
TKEDissipationVerticalDiffusivity{VerticallyImplicitTimeDiscretization}
├── maximum_tracer_diffusivity: Inf
├── maximum_tke_diffusivity: Inf
├── maximum_dissipation_diffusivity: Inf
├── maximum_viscosity: Inf
├── minimum_tke: 1.0e-6
├── negative_tke_damping_time_scale: 60.0
├── tke_dissipation_time_step: Nothing
├── tke_dissipation_equations: Oceananigans.TurbulenceClosures.TKEBasedVerticalDiffusivities.TKEDissipationEquations{Float64}
│   ├── Cᵋϵ: 1.92
│   ├── Cᴾϵ: 1.44
│   ├── Cᵇϵ⁺: -0.65
│   ├── Cᵇϵ⁻: -0.65
│   ├── Cᵂu★: 0.0
│   └── CᵂwΔ: 0.0
└── stability_functions: VariableStabilityFunctions{Float64}:
    ├── Cσe: 1.0
    ├── Cσϵ: 1.2
    ├── Cu₀: 0.1067
    ├── Cu₁: 0.0173
    ├── Cu₂: -0.0001205
    ├── Cc₀: 0.112
    ├── Cc₁: 0.003766
    ├── Cc₂: 0.0008871
    ├── Cd₀: 1.0
    ├── Cd₁: 0.2398
    ├── Cd₂: 0.02872
    ├── Cd₃: 0.005154
    ├── Cd₄: 0.00693
    └── Cd₅: -0.0003372</code></pre><h3 id="IsopycnalSkewSymmetricDiffusivity"><a class="docs-heading-anchor" href="#IsopycnalSkewSymmetricDiffusivity"><code>IsopycnalSkewSymmetricDiffusivity</code></a><a id="IsopycnalSkewSymmetricDiffusivity-1"></a><a class="docs-heading-anchor-permalink" href="#IsopycnalSkewSymmetricDiffusivity" title="Permalink"></a></h3><p><a href="#IsopycnalSkewSymmetricDiffusivity"><code>IsopycnalSkewSymmetricDiffusivity</code></a> parameterizes mesoscale eddies using the Gent-McWilliams/Redi scheme, as developed by <a href="../../references/#GentMcWilliams90">Gent and McWilliams (1990)</a> and <a href="../../references/#Redi82">Redi (1982)</a>. This closure requires to be imported from <code>TurbulenceClosures</code>:</p><pre><code class="language-julia-repl hljs">julia&gt; using Oceananigans

julia&gt; using Oceananigans.TurbulenceClosures: IsopycnalSkewSymmetricDiffusivity

julia&gt; IsopycnalSkewSymmetricDiffusivity(κ_skew=1e3, κ_symmetric=1e3)
IsopycnalSkewSymmetricDiffusivity:
├── κ_skew: 1000.0
├── κ_symmetric: 1000.0
├── isopycnal_tensor: Oceananigans.TurbulenceClosures.SmallSlopeIsopycnalTensor{Float64}
└── slope_limiter: FluxTapering{Float64}</code></pre><p>The <code>κ_skew</code> parameter controls the eddy-induced (bolus) transport, while <code>κ_symmetric</code> controls along-isopycnal diffusion.</p><h3 id="hydrostatic-example"><a class="docs-heading-anchor" href="#hydrostatic-example">Combining closures for hydrostatic simulations</a><a id="hydrostatic-example-1"></a><a class="docs-heading-anchor-permalink" href="#hydrostatic-example" title="Permalink"></a></h3><p>A typical hydrostatic simulation might combine resolution-dependent horizontal biharmonic viscosity with a TKE-based vertical mixing scheme:</p><pre><code class="language-julia-repl hljs">julia&gt; horizontal_closure = HorizontalScalarBiharmonicDiffusivity(ν=νhb, discrete_form=true, parameters=5days)
ScalarBiharmonicDiffusivity{HorizontalFormulation}(ν=Oceananigans.TurbulenceClosures.DiscreteDiffusionFunction{Nothing, Nothing, Nothing, Float64, typeof(νhb)}, κ=0.0)

julia&gt; vertical_closure = CATKEVerticalDiffusivity();

julia&gt; closure = (horizontal_closure, vertical_closure);

julia&gt; summary(horizontal_closure)
&quot;ScalarBiharmonicDiffusivity{HorizontalFormulation}(ν=Oceananigans.TurbulenceClosures.DiscreteDiffusionFunction{Nothing, Nothing, Nothing, Float64, typeof(νhb)}, κ=0.0)&quot;</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../buoyancy_and_equation_of_state/">« Buoyancy and equations of state</a><a class="docs-footer-nextpage" href="../boundary_conditions/">Boundary conditions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Thursday 25 December 2025 19:53">Thursday 25 December 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
