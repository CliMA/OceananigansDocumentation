<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Turbulence closures · Oceananigans.jl</title><meta name="title" content="Turbulence closures · Oceananigans.jl"/><meta property="og:title" content="Turbulence closures · Oceananigans.jl"/><meta property="twitter:title" content="Turbulence closures · Oceananigans.jl"/><meta name="description" content="Documentation for Oceananigans.jl."/><meta property="og:description" content="Documentation for Oceananigans.jl."/><meta property="twitter:description" content="Documentation for Oceananigans.jl."/><meta property="og:url" content="https://clima.github.io/OceananigansDocumentation/stable/physics/turbulence_closures/"/><meta property="twitter:url" content="https://clima.github.io/OceananigansDocumentation/stable/physics/turbulence_closures/"/><link rel="canonical" href="https://clima.github.io/OceananigansDocumentation/stable/physics/turbulence_closures/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Oceananigans.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../quick_start/">Quick start</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../literated/one_dimensional_diffusion/">One-dimensional diffusion</a></li><li><a class="tocitem" href="../../literated/two_dimensional_turbulence/">Two-dimensional turbulence</a></li><li><a class="tocitem" href="../../literated/internal_wave/">Internal wave</a></li><li><a class="tocitem" href="../../literated/internal_tide/">Internal tide by a seamount</a></li><li><a class="tocitem" href="../../literated/convecting_plankton/">Convecting plankton</a></li><li><a class="tocitem" href="../../literated/ocean_wind_mixing_and_convection/">Ocean wind mixing and convection</a></li><li><a class="tocitem" href="../../literated/langmuir_turbulence/">Langmuir turbulence</a></li><li><a class="tocitem" href="../../literated/baroclinic_adjustment/">Baroclinic adjustment</a></li><li><a class="tocitem" href="../../literated/kelvin_helmholtz_instability/">Kelvin-Helmholtz instability</a></li><li><a class="tocitem" href="../../literated/shallow_water_Bickley_jet/">Shallow water Bickley jet</a></li><li><a class="tocitem" href="../../literated/horizontal_convection/">Horizontal convection</a></li><li><a class="tocitem" href="../../literated/tilted_bottom_boundary_layer/">Tilted bottom boundary layer</a></li></ul></li><li><a class="tocitem" href="../../grids/">Grids</a></li><li><a class="tocitem" href="../../fields/">Fields</a></li><li><a class="tocitem" href="../../operations/">Operations</a></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../models/models_overview/">Overview</a></li><li><a class="tocitem" href="../../models/coriolis/">Coriolis forces</a></li><li><a class="tocitem" href="../../models/buoyancy_and_equation_of_state/">Buoyancy and equations of state</a></li><li><a class="tocitem" href="../../models/turbulence_closures/">Turbulence closures</a></li><li><a class="tocitem" href="../../models/boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../../models/forcing_functions/">Forcings</a></li><li><a class="tocitem" href="../../models/lagrangian_particles/">Lagrangian particles</a></li><li><a class="tocitem" href="../../models/background_fields/">Background fields</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../simulations/simulations_overview/">Overview</a></li><li><a class="tocitem" href="../../simulations/schedules/">Schedules</a></li><li><a class="tocitem" href="../../simulations/output_writers/">Output writers</a></li><li><a class="tocitem" href="../../simulations/checkpointing/">Checkpointing</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9" type="checkbox" checked/><label class="tocitem" for="menuitem-9"><span class="docs-label">Physics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../notation/">Coordinate system and notation</a></li><li><a class="tocitem" href="../boussinesq/">Boussinesq approximation</a></li><li><input class="collapse-toggle" id="menuitem-9-3" type="checkbox"/><label class="tocitem" for="menuitem-9-3"><span class="docs-label"><code>NonhydrostaticModel</code></span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../nonhydrostatic_model/">Nonhydrostatic model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9-4" type="checkbox"/><label class="tocitem" for="menuitem-9-4"><span class="docs-label"><code>HydrostaticFreeSurfaceModel</code></span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../hydrostatic_free_surface_model/">Hydrostatic model with a free surface</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9-5" type="checkbox"/><label class="tocitem" for="menuitem-9-5"><span class="docs-label"><code>ShallowWaterModel</code></span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../shallow_water_model/">Shallow water model</a></li></ul></li><li><a class="tocitem" href="../boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../buoyancy_and_equations_of_state/">Buoyancy models and equations of state</a></li><li><a class="tocitem" href="../coriolis_forces/">Coriolis forces</a></li><li class="is-active"><a class="tocitem" href>Turbulence closures</a><ul class="internal"><li><a class="tocitem" href="#Constant-isotropic-diffusivity"><span>Constant isotropic diffusivity</span></a></li><li><a class="tocitem" href="#Constant-anisotropic-diffusivity"><span>Constant anisotropic diffusivity</span></a></li><li><a class="tocitem" href="#Scalar-biharmonic-diffusivity"><span>Scalar biharmonic diffusivity</span></a></li><li><a class="tocitem" href="#Smagorinsky-Lilly-turbulence-closure"><span>Smagorinsky-Lilly turbulence closure</span></a></li><li><a class="tocitem" href="#Anisotropic-minimum-dissipation-(AMD)-turbulence-closure"><span>Anisotropic minimum dissipation (AMD) turbulence closure</span></a></li><li><a class="tocitem" href="#Convective-adjustment-vertical-diffusivity"><span>Convective adjustment vertical diffusivity</span></a></li></ul></li><li><a class="tocitem" href="../surface_gravity_waves/">Surface gravity waves and the Craik-Leibovich approximation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">Numerical implementation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../numerical_implementation/finite_volume/">Finite volume method</a></li><li><a class="tocitem" href="../../numerical_implementation/spatial_operators/">Spatial operators</a></li><li><a class="tocitem" href="../../numerical_implementation/generalized_vertical_coordinates/">Generalized vertical coordinates</a></li><li><a class="tocitem" href="../../numerical_implementation/pressure_decomposition/">Pressure decomposition</a></li><li><a class="tocitem" href="../../numerical_implementation/time_stepping/">Time stepping</a></li><li><a class="tocitem" href="../../numerical_implementation/boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../../numerical_implementation/elliptic_solvers/">Elliptic solvers</a></li><li><a class="tocitem" href="../../numerical_implementation/large_eddy_simulation/">Large eddy simulation</a></li></ul></li><li><a class="tocitem" href="../../simulation_tips/">Simulation tips</a></li><li><a class="tocitem" href="../../contributing/">Contributor&#39;s guide</a></li><li><a class="tocitem" href="../../gallery/">Gallery</a></li><li><a class="tocitem" href="../../references/">References</a></li><li><input class="collapse-toggle" id="menuitem-15" type="checkbox"/><label class="tocitem" for="menuitem-15"><span class="docs-label">Appendix</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../appendix/staggered_grid/">Staggered grid</a></li><li><a class="tocitem" href="../../appendix/fractional_step/">Fractional step method</a></li><li><a class="tocitem" href="../../appendix/convergence_tests/">Convergence tests</a></li><li><a class="tocitem" href="../../appendix/benchmarks/">Performance benchmarks</a></li><li><a class="tocitem" href="../../appendix/library/">Library</a></li><li><a class="tocitem" href="../../appendix/function_index/">Function index</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Physics</a></li><li class="is-active"><a href>Turbulence closures</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Turbulence closures</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/Oceananigans.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/Oceananigans.jl/blob/main/docs/src/physics/turbulence_closures.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Turbulence-closures"><a class="docs-heading-anchor" href="#Turbulence-closures">Turbulence closures</a><a id="Turbulence-closures-1"></a><a class="docs-heading-anchor-permalink" href="#Turbulence-closures" title="Permalink"></a></h1><p>The turbulence closure selected by the user determines the form of stress divergence <span>$\boldsymbol{\nabla} \boldsymbol{\cdot} \boldsymbol{\tau}$</span> and diffusive flux divergence <span>$\boldsymbol{\nabla} \boldsymbol{\cdot} \boldsymbol{q}_c$</span> in the momentum and tracer conservation equations.</p><h2 id="Constant-isotropic-diffusivity"><a class="docs-heading-anchor" href="#Constant-isotropic-diffusivity">Constant isotropic diffusivity</a><a id="Constant-isotropic-diffusivity-1"></a><a class="docs-heading-anchor-permalink" href="#Constant-isotropic-diffusivity" title="Permalink"></a></h2><p>In a constant isotropic diffusivity model, the kinematic stress tensor is defined</p><p class="math-container">\[\tau_{ij} = - \nu \Sigma_{ij} \, ,\]</p><p>where <span>$\nu$</span> is a constant viscosity and <span>$\Sigma_{ij} \equiv \tfrac{1}{2} \left ( v_{i, j} + v_{j, i} \right )$</span> is the strain-rate tensor. The divergence of <span>$\boldsymbol{\tau}$</span> is then</p><p class="math-container">\[\boldsymbol{\nabla} \boldsymbol{\cdot} \boldsymbol{\tau} = -\nu \nabla^2 \boldsymbol{v} \, .\]</p><p>Similarly, the diffusive tracer flux is <span>$\boldsymbol{q}_c = - \kappa \boldsymbol{\nabla} c$</span> for tracer diffusivity <span>$\kappa$</span>, and the diffusive tracer flux divergence is</p><p class="math-container">\[\boldsymbol{\nabla} \boldsymbol{\cdot} \boldsymbol{q}_c = - \kappa \nabla^2 c \, .\]</p><p>Each tracer may have a unique diffusivity <span>$\kappa$</span>.</p><h2 id="Constant-anisotropic-diffusivity"><a class="docs-heading-anchor" href="#Constant-anisotropic-diffusivity">Constant anisotropic diffusivity</a><a id="Constant-anisotropic-diffusivity-1"></a><a class="docs-heading-anchor-permalink" href="#Constant-anisotropic-diffusivity" title="Permalink"></a></h2><p>A constant anisotropic diffusivity implies a constant tensor diffusivity <span>$\nu_{j k}$</span> and stress <span>$\boldsymbol{\tau}_{ij} = \nu_{j k} u_{i, k}$</span> with non-zero components <span>$\nu_{11} = \nu_{22} = \nu_h$</span> and <span>$\nu_{33} = \nu_z$</span>. With this form the kinematic stress divergence becomes</p><p class="math-container">\[\boldsymbol{\nabla} \boldsymbol{\cdot} \boldsymbol{\tau} = - \left [ \nu_h \left ( \partial_x^2 + \partial_y^2 \right )
                                    + \nu_v \partial_z^2 \right ] \boldsymbol{v} \, ,\]</p><p>and diffusive flux divergence</p><p class="math-container">\[\boldsymbol{\nabla} \boldsymbol{\cdot} \boldsymbol{q}_c = - \left [ \kappa_{h} \left ( \partial_x^2 + \partial_y^2 \right )
                                    + \kappa_{v} \partial_z^2 \right ] c \, ,\]</p><p>in terms of the horizontal viscosities and diffusivities, <span>$\nu_h$</span> and <span>$\kappa_h$</span>, and the vertical viscosity and diffusivities, <span>$\nu_z$</span> and <span>$\kappa_z$</span>. Each tracer may have a unique diffusivity components <span>$\kappa_h$</span> and <span>$\kappa_v$</span>.</p><h2 id="Scalar-biharmonic-diffusivity"><a class="docs-heading-anchor" href="#Scalar-biharmonic-diffusivity">Scalar biharmonic diffusivity</a><a id="Scalar-biharmonic-diffusivity-1"></a><a class="docs-heading-anchor-permalink" href="#Scalar-biharmonic-diffusivity" title="Permalink"></a></h2><p>A constant biharmonic diffusivity implies a constant tensor diffusivity <span>$\nu_{j k}$</span> and stress<span>$\boldsymbol{\tau}_{ij} = \nu_{j k} \partial_k^3 u_i$</span> with non-zero components <span>$\nu_{11} = \nu_{22} = \nu_h$</span> and <span>$\nu_{33} = \nu_z$</span>.</p><p>With this form the kinematic stress divergence becomes</p><p class="math-container">\[\boldsymbol{\nabla} \boldsymbol{\cdot} \boldsymbol{\tau} = - \left [ \nu_h \left ( \partial_x^2 + \partial_y^2 \right )^2
                                    + \nu_v \partial_z^4 \right ] \boldsymbol{v} \, ,\]</p><p>and diffusive flux divergence</p><p class="math-container">\[\boldsymbol{\nabla} \boldsymbol{\cdot} \boldsymbol{q}_c = - \left [ \kappa_{h} \left ( \partial_x^2 + \partial_y^2 \right )^2
                                    + \kappa_{v} \partial_z^4 \right ] c \, ,\]</p><p>in terms of the horizontal biharmonic viscosities and diffusivities, <span>$\nu_h$</span> and <span>$\kappa_h$</span>, and the vertical biharmonic viscosity and diffusivities, <span>$\nu_z$</span> and <span>$\kappa_z$</span>. Each tracer may have a unique diffusivity components <span>$\kappa_h$</span> and <span>$\kappa_z$</span>.</p><h2 id="Smagorinsky-Lilly-turbulence-closure"><a class="docs-heading-anchor" href="#Smagorinsky-Lilly-turbulence-closure">Smagorinsky-Lilly turbulence closure</a><a id="Smagorinsky-Lilly-turbulence-closure-1"></a><a class="docs-heading-anchor-permalink" href="#Smagorinsky-Lilly-turbulence-closure" title="Permalink"></a></h2><p>In the turbulence closure proposed by <a href="../../references/#Lilly62">Lilly (1962)</a> and <a href="../../references/#Smagorinsky63">Smagorinsky (1963)</a>, the subgrid stress associated with unresolved turbulent motions is modeled diffusively via</p><p class="math-container">\[\tau_{ij} = - 2 \nu_e \Sigma_{ij} \, ,\]</p><p>where <span>$\Sigma_{ij} = \tfrac{1}{2} \left ( v_{i, j} + v_{j, i} \right )$</span> is the resolved strain rate. The eddy viscosity is given by</p><p class="math-container">\[    \begin{align}
    \nu_e = \left ( C \Delta_f \right )^2 \sqrt{ \Sigma^2 } \, \varsigma(N^2 / \Sigma^2) \, ,
    \label{eq:smagorinsky-viscosity}
    \end{align}\]</p><p>where <span>$\Delta_f$</span> is the &quot;filter width&quot; associated with the finite volume grid spacing and <span>$C$</span> is a user-specified model constant, <span>$\Sigma^2 \equiv \Sigma_{ij} \Sigma_{ij}$</span>. The factor <span>$\varsigma(N^2 / \Sigma^2)$</span> reduces <span>$\nu_e$</span> in regions of strong stratification via</p><p class="math-container">\[    \varsigma(N^2 / \Sigma^2) = \sqrt{1 - \min \left ( 1, C_b N^2 / \Sigma^2 \right )} \, ,\]</p><p>where <span>$N^2 = \max \left (0, \partial_z b \right )$</span> is the squared buoyancy frequency for stable stratification with <span>$\partial_z b &gt; 0$</span> and <span>$C_b$</span> is a user-specified constant.  Lilly (1962) proposed <span>$C_b = 1/Pr$</span>, where <span>$Pr$</span> is a turbulent Prandtl number. The filter width for the Smagorinsky-Lilly closure is</p><p class="math-container">\[\Delta_f(\boldsymbol{x}) = \left ( \Delta x \Delta y \Delta z \right)^{1/3} \, ,\]</p><p>where <span>$\Delta x$</span>, <span>$\Delta y$</span>, and <span>$\Delta z$</span> are the grid spacing in the <span>$\boldsymbol{\hat x}$</span>, <span>$\boldsymbol{\hat y}$</span>, and <span>$\boldsymbol{\hat z}$</span> directions at location <span>$\boldsymbol{x} = (x, y, z)$</span>.</p><p>The effect of subgrid turbulence on tracer mixing is also modeled diffusively via</p><p class="math-container">\[\boldsymbol{q}_c = - \kappa_e \boldsymbol{\nabla} c \, ,\]</p><p>where the eddy diffusivity <span>$\kappa_e$</span> is</p><p class="math-container">\[\kappa_e = \frac{\nu_e}{Pr} + \kappa \, .\]</p><p>Both <span>$Pr$</span> and <span>$\kappa$</span> may be set independently for each tracer.</p><h2 id="Anisotropic-minimum-dissipation-(AMD)-turbulence-closure"><a class="docs-heading-anchor" href="#Anisotropic-minimum-dissipation-(AMD)-turbulence-closure">Anisotropic minimum dissipation (AMD) turbulence closure</a><a id="Anisotropic-minimum-dissipation-(AMD)-turbulence-closure-1"></a><a class="docs-heading-anchor-permalink" href="#Anisotropic-minimum-dissipation-(AMD)-turbulence-closure" title="Permalink"></a></h2><p>The anisotropic minimum dissipation (AMD) model proposed by <a href="../../references/#Verstappen18">Verstappen (2018)</a> and was described and tested by <a href="../../references/#Vreugdenhil18">Vreugdenhil and Taylor (2018)</a>. The AMD model uses an eddy diffusivity hypothesis similar the Smagorinsky-Lilly model. In the AMD model, the eddy viscosity and diffusivity for each tracer are defined in terms of eddy viscosity and diffusivity <em>predictors</em> <span>$\nu_e^\dagger$</span> and <span>$\kappa_e^\dagger$</span>, such that</p><p class="math-container">\[    \nu_e = \max \left ( 0, \nu_e^\dagger \right ) + \nu
    \quad \text{and} \quad
    \kappa_e = \max \left ( 0, \kappa_e^\dagger \right ) + \kappa \, ,\]</p><p>to ensure that <span>$\nu_e \ge 0$</span> and <span>$\kappa_e \ge 0$</span>, where <span>$\nu$</span> and <span>$\kappa$</span> are the constant isotropic background viscosity and diffusivities for each tracer. The eddy viscosity predictor is</p><p class="math-container">\[    \begin{equation}
    \nu_e^\dagger = C \Delta_f^2
    \frac
        {(\hat{\partial}_k \hat{v}_i) (\hat{\partial}_k \hat{v}_j) \hat{\Sigma}_{ij}
        + C_b \hat{\delta}_{i3} (\hat{\partial}_k \hat{v_i}) (\hat{\partial}_k b)}
        {(\hat{\partial}_l \hat{v}_m) (\hat{\partial}_l \hat{v}_m)} \, ,
    \label{eq:nu-dagger}
    \end{equation}\]</p><p>while the eddy diffusivity predictor for tracer <span>$c$</span> is</p><p class="math-container">\[    \begin{equation}
    \label{eq:kappa-dagger}
    \kappa_e^\dagger = C \Delta_f^2
    \frac
        {(\hat{\partial}_k \hat{v}_i) (\hat{\partial}_k c) (\hat{\partial}_i c)}
        {(\hat{\partial}_l c) (\hat{\partial}_l c)} \, .
    \end{equation}\]</p><p>In the definitions of the eddy viscosity and eddy diffusivity predictor, <span>$C$</span> and <span>$C_b$</span> are user-specified model constants, <span>$\Delta_f$</span> is a &quot;filter width&quot; associated with the finite volume grid spacing, and the hat decorators on partial derivatives, velocities, and the Kronecker delta <span>$\hat \delta_{i3}$</span> are defined such that</p><p class="math-container">\[    \hat \partial_i \equiv \Delta_i \partial_i, \qquad
    \hat{v}_i(x, t) \equiv \frac{v_i(x, t)}{\Delta_i}, \quad \text{and} \quad
    \hat{\delta}_{i3} \equiv \frac{\delta_{i3}}{\Delta_3} \, .\]</p><p>A velocity gradient, for example, is therefore <span>$\hat{\partial}_i \hat{v}_j(x, t) = \frac{\Delta_i}{\Delta_j} \partial_i v_j(x, t)$</span>, while the normalized strain tensor is</p><p class="math-container">\[    \hat{\Sigma}_{ij} =
        \frac{1}{2} \left[ \hat{\partial}_i \hat{v}_j(x, t) + \hat{\partial}_j \hat{v}_i(x, t) \right] \, .\]</p><p>The filter width <span>$\Delta_f$</span> in that appears in the viscosity and diffusivity predictors is taken as the square root of the harmonic mean of the squares of the filter widths in each direction:</p><p class="math-container">\[    \frac{1}{\Delta_f^2} = \frac{1}{3} \left(   \frac{1}{\Delta x^2}
                                              + \frac{1}{\Delta y^2}
                                              + \frac{1}{\Delta z^2} \right) \, .\]</p><p>The constant <span>$C_b$</span> permits the &quot;buoyancy modification&quot; term it multiplies to be omitted from a calculation. By default we use the model constants <span>$C = 1/12$</span> and <span>$C_b = 0$</span>.</p><h2 id="Convective-adjustment-vertical-diffusivity"><a class="docs-heading-anchor" href="#Convective-adjustment-vertical-diffusivity">Convective adjustment vertical diffusivity</a><a id="Convective-adjustment-vertical-diffusivity-1"></a><a class="docs-heading-anchor-permalink" href="#Convective-adjustment-vertical-diffusivity" title="Permalink"></a></h2><p>This closure aims to model the enhanced mixing that occurs due to convection. At every point and for every time instance, the closure diagnoses the gravitational stability of the fluid and applies the vertical diffusivities (i) <code>background_νz</code> to <code>u, v</code> and <code>background_κz</code> to all tracers if the fluid is gravitationally neutral or stable with <span>$∂b/∂z ≥ 0$</span>, or (ii) <code>convective_νz</code> and <code>convective_κz</code> if <span>$∂b/∂z &lt; 0$</span>.</p><p>This closure is a plausible model for convection if <code>convective_κz</code> <span>$\gg$</span> <code>background_κz</code> and <code>convective_νz</code> <span>$\gg$</span> <code>background_νz</code>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../coriolis_forces/">« Coriolis forces</a><a class="docs-footer-nextpage" href="../surface_gravity_waves/">Surface gravity waves and the Craik-Leibovich approximation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Thursday 25 December 2025 14:05">Thursday 25 December 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
