<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Large eddy simulation · Oceananigans.jl</title><link rel="canonical" href="https://climate-machine.github.io/Oceananigans.jl/latest/manual/large_eddy_simulation/index.html"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Oceananigans.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../generated/simple_diffusion/">One-dimensional diffusion</a></li><li><a class="tocitem" href="../../generated/two_dimensional_turbulence/">Two-dimensional turbulence</a></li><li><a class="tocitem" href="../../generated/ocean_wind_mixing_and_convection/">Ocean wind mixing and convection</a></li><li><a class="tocitem" href="../../generated/ocean_convection_with_plankton/">Ocean convection with plankton</a></li><li><a class="tocitem" href="../../generated/internal_wave/">Internal wave</a></li></ul></li><li><a class="tocitem" href="../model_setup/">Model setup</a></li><li><a class="tocitem" href="../physics/">Physics</a></li><li><span class="tocitem">Numerical implementation</span><ul><li><a class="tocitem" href="../pressure_decomposition/">Pressure decomposition</a></li><li><a class="tocitem" href="../time_stepping/">Time stepping</a></li><li><a class="tocitem" href="../finite_volume/">Finite volume method</a></li><li><a class="tocitem" href="../spatial_operators/">Spatial operators</a></li><li><a class="tocitem" href="../boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../poisson_solvers/">Poisson solvers</a></li><li class="is-active"><a class="tocitem" href>Large eddy simulation</a><ul class="internal"><li><a class="tocitem" href="#Smagorinsky-Lilly-model-1"><span>Smagorinsky-Lilly model</span></a></li><li><a class="tocitem" href="#Anisotropic-minimum-dissipation-models-1"><span>Anisotropic minimum dissipation models</span></a></li></ul></li></ul></li><li><span class="tocitem">Verification experiments</span><ul><li><a class="tocitem" href="../../verification/taylor_green_vortex/">Taylor-Green vortex</a></li><li><a class="tocitem" href="../../verification/stratified_couette_flow/">Stratified Couette flow</a></li></ul></li><li><a class="tocitem" href="../../gallery/">Gallery</a></li><li><a class="tocitem" href="../../benchmarks/">Performance benchmarks</a></li><li><a class="tocitem" href="../../library/">Library</a></li><li><span class="tocitem">Appendix</span><ul><li><a class="tocitem" href="../staggered_grid/">Staggered grid</a></li><li><a class="tocitem" href="../fractional_step/">Fractional step method</a></li></ul></li><li><a class="tocitem" href="../../subject_index/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Numerical implementation</a></li><li class="is-active"><a href>Large eddy simulation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Large eddy simulation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/climate-machine/Oceananigans.jl/blob/master/docs/src/manual/large_eddy_simulation.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Large-eddy-simulation-1"><a class="docs-heading-anchor" href="#Large-eddy-simulation-1">Large eddy simulation</a><a class="docs-heading-anchor-permalink" href="#Large-eddy-simulation-1" title="Permalink"></a></h1><p>The idea behind large eddy simulation (LES) is to resolve the &quot;large eddies&quot; while modeling the effect of unresolved sub-grid scale motions. This is done usually be assuming eddy viscosity and eddy diffusivity models and providing an estimate for the eddy viscosity <span>$\nu_e$</span> and diffusivity <span>$\kappa_e$</span>.</p><p>Much of the early work on LES was motivated by the study of atmospheric boundary layer turbulence, being developed by \citet{Smagorinsky63} and \citet{Lilly66}, then first implemented by \citet{Deardorff70,Deardorff74}.</p><p>In the LES framework, the Navier-Stokes equations are averaged in the same way as \citet{Reynolds1895} except that the mean field <span>$\overline{\bm{u}}$</span> is obtained via convolution with a filter convolution kernel~<span>$G$</span></p><div>\[\overline{\bm{u}(\bm{x}, t)} = G \star \bm{u} =
  \int_{-\infty}^\infty \int_{-\infty}^\infty
  \bm{u}(\bm{x}^\prime, t) G(\bm{x} - \bm{x}^\prime, t - \tau) \, d\bm{x}^\prime \, d\tau\]</div><p>as described by \citet{Leonard75} who introduced the general filtering formalism.</p><p>The <span>$\overline{u_i^\prime u_j^\prime}$</span> terms are now components of what is called the sub-grid scale (SGS) stress tensor <span>$\tau^\text{SGS}_{ij}$</span>, which looks the same as the Reynolds stress tensor so we will drop the SGS superscript.</p><p>It is probably important to note that the large eddy simulation filtering operation does not satisfy the properties of a Reynolds operator \citep[\S 2.1]{sagaut06} and that in general, the filtered residual is not zero: <span>$\overline{\bm{u}^\prime(\bm{x}, t)} \ne 0$</span>.</p><p>\citet[\S13.2]{Pope00} lists a number of popular choices for the filter function <span>$G$</span>. For practical reasons we simply employ the box kernel</p><div>\[  G_\Delta = G(\bm{x}, t) = \frac{1}{\Delta} H \left( \frac{1}{2}\Delta - |\bm{x}| \right) \delta(t - t_n)\]</div><p>where <span>$H$</span> is the Heaviside function, <span>$\Delta$</span> is the grid spacing, and <span>$t_n$</span> is the current time step. With \eqref{eq:box-kernel} we get back the averaging operator originally used by \citet{Deardorff70}</p><div>\[\overline{\bm{u}(x, y, z, t)} =
  \frac{1}{\Delta x \Delta y \Delta z}
  \int_{x - \frac{1}{2}\Delta x}^{x + \frac{1}{2}\Delta x}
  \int_{y - \frac{1}{2}\Delta y}^{y + \frac{1}{2}\Delta y}
  \int_{z - \frac{1}{2}\Delta z}^{z + \frac{1}{2}\Delta z}
  \bm{u}(\xi, \eta, \zeta, t) \, d\xi \, d\eta \, d\zeta\]</div><p>which if evaluated at the cell centers just returns the cell averages we already compute in the finite volume method.</p><h2 id="Smagorinsky-Lilly-model-1"><a class="docs-heading-anchor" href="#Smagorinsky-Lilly-model-1">Smagorinsky-Lilly model</a><a class="docs-heading-anchor-permalink" href="#Smagorinsky-Lilly-model-1" title="Permalink"></a></h2><p>\citet{Smagorinsky63} estimated the eddy viscosity <span>$\nu_e$</span> via a characteristic length scale <span>$\Delta$</span> times a velocity scale given by <span>$\Delta |\overline{S}|$</span> where <span>$|\overline{S}| = \sqrt{2\overline{S}_{ij}\overline{S}_{ij}}$</span>. Thus the SGS stress tensor is given by</p><div>\[\tau_{ij} = -2\nu_e \overline{S}_{ij} = -2 (C_s \Delta)^2 |\overline{S}| \overline{S}_{ij}\]</div><p>where <span>$C_s$</span> is a dimensionless constant. The grid spacing is usually used for the characteristic length scale <span>$\Delta$</span>. The eddy diffusivities are calculated via <span>$\kappa_e = \nu_e / \text{Pr}_t$</span> where the turbulent Prandtl number <span>$\text{Pr}_t$</span> is usually chosen to be <span>$\mathcal{O}(1)$</span> from experimental observations.</p><p>Assuming that the SGS energy cascade is equal to the overall dissipation rate <span>$\varepsilon$</span> from the \citet{Kolmogorov41} theory, \citet{Lilly66} was able to derive a value of</p><div>\[C_s = \left( \frac{3}{2}C_K\pi^\frac{4}{3} \right)^{-\frac{3}{4}} \approx 0.16\]</div><p>using an empirical value of <span>$C_K \approx 1.6$</span> for the Kolmogorov constant. This seems reasonable for isotropic turbulence if the grid spacing <span>$\Delta$</span> falls in the inertial range. In practice, <span>$C_s$</span> is a tunable parameter.</p><p>Due to the presence of the constant <span>$C_s$</span>, the model is sometimes referred to as the \emph{constant Smagorinsky} model in contrast to \emph{dynamic Smagorinsky} models that dynamically compute <span>$C_s$</span> to account for effects such as buoyant convection.</p><h2 id="Anisotropic-minimum-dissipation-models-1"><a class="docs-heading-anchor" href="#Anisotropic-minimum-dissipation-models-1">Anisotropic minimum dissipation models</a><a class="docs-heading-anchor-permalink" href="#Anisotropic-minimum-dissipation-models-1" title="Permalink"></a></h2><p>Minimum-dissipation eddy-viscosity models are a class of LES closures that use the minimum eddy dissipation required to dissipate the energy of sub-grid scale motion. \citet{Rozema15} proposed the first minimum-dissipation model appropriate for use on anisotropic grids, termed the \emph{anisotropic minimum dissipation} (AMD) model.</p><p>It has a number of desirable properties over Smagorinsky-type closures: it is more cost-effective than dynamic Smagorinsky, it appropriately switches off in laminar and transitional flows, and it is consistent with the exact SGS stress tensor on both isotropic and anisotropic grids. \citet{Abkar16} extended the AMD model to model SGS scalar fluxes for tracer transport. \citet{Abkar17} further extended the model to include a buoyancy term that accounts for the contribution of buoyant forces to the production and suppression of turbulence.</p><p>\citet{Vreugdenhil18} derive a modified AMD model by following the requirement suggested by \citet{Verstappen18}, which entail normalising the displacement, the velocity, and the velocity gradient by the filter width to ensure that the resulting eddy dissipation properly counteracts the spurious kinetic energy transferred by convective nonlinearity, to derive a modified AMD model.</p><p>The eddy viscosity and diffusivity are defined in terms of eddy viscosity and diffusivity \emph{predictors} <span>$\nu_e^\dagger$</span> and <span>$\kappa_e^\dagger$</span>, such that</p><div>\[\nu_e = \text{max} \lbrace 0, \nu_e^\dagger \rbrace
\quad \text{and} \quad
\kappa_e = \text{max} \lbrace 0, \kappa_e^\dagger \rbrace\]</div><p>to ensure that <span>$\nu_e \ge 0$</span> and <span>$\kappa_e \ge 0$</span>. Leaving out the overlines and understanding that all variables represent the resolved/filtered variables, the eddy viscosity predictor is given by</p><div>\[\nu_e^\dagger = -(C\Delta)^2
  \frac
    {\left( \hat{\partial}_k \hat{u}_i \right) \left( \hat{\partial}_k \hat{u}_j \right) \hat{S}_{ij}
    + C_b\hat{\delta}_{i3} \alpha g \left( \hat{\partial}_k \hat{u_i} \right) \hat{\partial}_k \theta}
    {\left( \hat{\partial}_l \hat{u}_m \right) \left( \hat{\partial}_l \hat{u}_m \right)}\]</div><p>and the eddy diffusivity predictor by</p><div>\[\kappa_e^\dagger = -(C\Delta)^2
\frac
    {\left( \hat{\partial}_k \hat{u}_i \right) \left( \hat{\partial}_k \hat{\theta} \right) \hat{\partial}_i \theta}
    {\left( \hat{\partial}_l \hat{\theta} \right) \left( \hat{\partial}_l \hat{\theta} \right)}\]</div><p>where</p><div>\[  \hat{x}_i = \frac{x_i}{\Delta_i}, \quad
  \hat{u}_i(\hat{x}, t) = \frac{u_i(x, t)}{\Delta_i}, \quad
  \hat{\partial}_i \hat{u}_j(\hat{x}, t) = \frac{\Delta_i}{\Delta_j} \partial_i u_j(x, t), \quad
  \hat{\delta}_{i3} = \frac{\delta_{i3}}{\Delta 3}\]</div><p>so that the normalized rate of strain tensor is</p><div>\[\hat{S}_{ij} =
  \frac{1}{2} \left[ \hat{\partial}_i \hat{u}_j(\hat{x}, t) + \hat{\partial}_j \hat{u}_i(\hat{x}, t) \right]\]</div><p>In equations \eqref{eq:nu-dagger}–\eqref{eq:S-hat} <span>$C$</span> is a modified Poincaré &quot;constant&quot; that is independent from the filter width <span>$\Delta$</span> but does depend on the accuracy of the discretization method used. \citet{Abkar16} cite <span>$C^2 = \frac{1}{12}$</span> for a spectral method and <span>$C^2 = \frac{1}{3}$</span> for a second-order accurate scheme. <span>$\Delta_i$</span> is the filter width in the <span>$x_i$</span>-direction, and <span>$\Delta$</span> is given by the square root of the harmonic mean of the squares of the filter widths in each direction</p><div>\[    \frac{1}{\Delta^2} = \frac{1}{3} \left( \frac{1}{\Delta x^2} + \frac{1}{\Delta y^2} + \frac{1}{\Delta z^2} \right)\]</div><p>The term multiplying <span>$C_b$</span> is the buoyancy modification introduced by \citet{Abkar17} and is small for weakly stratified flows. We have introduced the <span>$C_b$</span> constant so that the buoyancy modification term may be turned on and off.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../poisson_solvers/">« Poisson solvers</a><a class="docs-footer-nextpage" href="../../verification/taylor_green_vortex/">Taylor-Green vortex »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 13 December 2019 00:49">Friday 13 December 2019</span>. Using Julia version 1.2.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
