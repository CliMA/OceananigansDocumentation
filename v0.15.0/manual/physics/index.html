<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Physics · Oceananigans.jl</title><link rel="canonical" href="https://climate-machine.github.io/Oceananigans.jl/latest/manual/physics/index.html"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.8.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.8.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.8.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Oceananigans.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/simple_diffusion/">One-dimensional diffusion</a></li><li><a class="tocitem" href="../../generated/two_dimensional_turbulence/">Two-dimensional turbulence</a></li><li><a class="tocitem" href="../../generated/ocean_wind_mixing_and_convection/">Ocean wind mixing and convection</a></li><li><a class="tocitem" href="../../generated/ocean_convection_with_plankton/">Ocean convection with plankton</a></li><li><a class="tocitem" href="../../generated/internal_wave/">Internal wave</a></li></ul></li><li class="is-active"><a class="tocitem" href>Physics</a><ul class="internal"><li><a class="tocitem" href="#Coordinate-system-and-notation-1"><span>Coordinate system and notation</span></a></li><li><a class="tocitem" href="#The-Boussinesq-approximation-1"><span>The Boussinesq approximation</span></a></li><li><a class="tocitem" href="#The-momentum-conservation-equation-1"><span>The momentum conservation equation</span></a></li><li><a class="tocitem" href="#The-tracer-conservation-equation-1"><span>The tracer conservation equation</span></a></li><li><a class="tocitem" href="#Buoyancy-model-and-equations-of-state-1"><span>Buoyancy model and equations of state</span></a></li><li><a class="tocitem" href="#Coriolis-forces-1"><span>Coriolis forces</span></a></li><li><a class="tocitem" href="#Turbulence-closures-1"><span>Turbulence closures</span></a></li><li><a class="tocitem" href="#Surface-gravity-waves-and-the-Craik-Leibovich-approximation-1"><span>Surface gravity waves and the Craik-Leibovich approximation</span></a></li><li><a class="tocitem" href="#Boundary-conditions-1"><span>Boundary conditions</span></a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Numerical implementation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../pressure_decomposition/">Pressure decomposition</a></li><li><a class="tocitem" href="../time_stepping/">Time stepping</a></li><li><a class="tocitem" href="../finite_volume/">Finite volume method</a></li><li><a class="tocitem" href="../spatial_operators/">Spatial operators</a></li><li><a class="tocitem" href="../boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../poisson_solvers/">Poisson solvers</a></li><li><a class="tocitem" href="../large_eddy_simulation/">Large eddy simulation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Verification</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../verification/taylor_green_vortex/">Taylor-Green vortex</a></li><li><a class="tocitem" href="../../verification/stratified_couette_flow/">Stratified Couette flow</a></li></ul></li></ul></li><li><a class="tocitem" href="../../gallery/">Gallery</a></li><li><a class="tocitem" href="../../benchmarks/">Benchmarks</a></li><li><a class="tocitem" href="../../library/">Library</a></li><li><a class="tocitem" href="../../subject_index/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Physics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Physics</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/climate-machine/Oceananigans.jl/blob/master/docs/src/manual/physics.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Navier-Stokes-and-tracer-conservation-equations-1">Navier-Stokes and tracer conservation equations<a class="docs-heading-anchor" href="#Navier-Stokes-and-tracer-conservation-equations-1" title="Permalink"></a></h1><p>Oceananigans.jl solves the incompressible Navier-Stokes equations and an arbitrary  number of tracer conservation equations.  Physics associated with individual terms in the momentum and tracer conservation  equations –- the background rotation rate of the equation&#39;s reference frame,  gravitational effects associated with buoyant tracers under the Boussinesq  approximation<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>, generalized stresses and tracer fluxes associated with viscous and  diffusive physics, and arbitrary &quot;forcing functions&quot; –- are determined by the whims of the  user.</p><h2 id="Coordinate-system-and-notation-1">Coordinate system and notation<a class="docs-heading-anchor" href="#Coordinate-system-and-notation-1" title="Permalink"></a></h2><p>Oceananigans.jl is formulated in a Cartesian coordinate system  <span>$\bm{x} = (x, y, z)$</span> with unit vectors <span>$\bm{\hat x}$</span>, <span>$\bm{\hat y}$</span>, and <span>$\bm{\hat z}$</span>,  where <span>$\bm{\hat x}$</span> points east, <span>$\bm{\hat y}$</span> points north, and <span>$\bm{\hat z}$</span> points &#39;upward&#39;,  opposite the direction of gravitational acceleration.  We denote time with <span>$t$</span>, partial derivatives with respect to time <span>$t$</span> or a coordinate <span>$x$</span>  with <span>$\partial_t$</span> or <span>$\partial_x$</span>, and denote the gradient operator  <span>$\bm{\nabla} \equiv \partial_x \bm{\hat x} + \partial_y \bm{\hat y} + \partial_z \bm{\hat z}$</span>. We use <span>$u$</span>, <span>$v$</span>, and <span>$w$</span> to denote the east, north, and vertical velocity components,  such that <span>$\bm{u} = u \bm{\hat x} + v \bm{\hat y} + w \bm{\hat z}$</span>.</p><h2 id="The-Boussinesq-approximation-1">The Boussinesq approximation<a class="docs-heading-anchor" href="#The-Boussinesq-approximation-1" title="Permalink"></a></h2><p>In Oceananigans.jl the fluid density <span>$\rho$</span> is, in general, decomposed into three  components: </p><div>\[    \rho(\bm{x}, t) = \rho_0 + \rho_*(z) + \rho&#39;(\bm{x}, t) \, ,\]</div><p>where <span>$\rho_0$</span> is a constant &#39;reference&#39; density, <span>$\rho_*(z)$</span> is a background density  profile typically associated with the hydrostatic compression of seawater in the deep ocean,  and <span>$\rho&#39;(\bm{x}, t)$</span> is the dynamic component of density corresponding to inhomogeneous  distributions of a buoyant tracer such as temperature or salinity. The fluid <em>buoyancy</em>, associated with the buoyant acceleration of fluid, is  defined in terms of <span>$\rho&#39;$</span> as</p><div>\[    b = - \frac{g \rho&#39;}{\rho_0} \, ,\]</div><p>where <span>$g$</span> is gravitational acceleration.</p><p>The Boussinesq approximation is valid when <span>$\rho_* + \rho&#39; \ll \rho_0$</span>, which implies the  fluid is approximately <em>incompressible</em><sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup> In this case, the mass conservation equation reduces to the continuity equation</p><div>\[    \bm{\nabla} \bm{\cdot} \bm{u} = \partial_x u + \partial_y v + \partial_z w = 0 \, .
    \tag{eq:continuity}\]</div><h2 id="The-momentum-conservation-equation-1">The momentum conservation equation<a class="docs-heading-anchor" href="#The-momentum-conservation-equation-1" title="Permalink"></a></h2><p>The equations governing the conservation of momentum in a rotating fluid, including buoyancy via the Boussinesq approximation and including the averaged effects of surface gravity waves at the top of the domain via the Craik-Leibovich approximation are</p><div>\[    \partial_t \bm{u} + \left ( \bm{u} \bm{\cdot} \bm{\nabla} \right ) \bm{u} 
        + \left ( \bm{f} - \bm{\nabla} \times \bm{u}^S \right ) \times \bm{u} = - \bm{\nabla} \phi + b \bm{\hat z} 
        - \bm{\nabla} \bm{\cdot} \bm{\tau} - \partial_t \bm{u}^S + \bm{F_u} \, ,
    \tag{eq:momentum}\]</div><p>where <span>$b$</span> is buoyancy, <span>$\bm{\tau}$</span> is the kinematic stress tensor, <span>$\bm{F_u}$</span> denotes an internal forcing of the velocity field <span>$\bm{u}$</span>, <span>$\phi$</span> is the potential  associated with kinematic and constant hydrostatic contributions to pressure,  <span>$\bm{u}^S$</span> is the &#39;Stokes drift&#39; velocity field associated with surface gravity waves, and <span>$\bm{f}$</span> is <em>Coriolis parameter</em>, or the background vorticity associated with the  specified rate of rotation of the frame of reference.</p><h2 id="The-tracer-conservation-equation-1">The tracer conservation equation<a class="docs-heading-anchor" href="#The-tracer-conservation-equation-1" title="Permalink"></a></h2><p>The conservation law for tracers in Oceananigans.jl is</p><div>\[    \partial_t c + \bm{u} \bm{\cdot} \bm{\nabla} c = - \bm{\nabla} \bm{\cdot} \bm{q}_c + F_c \, ,
    \tag{eq:tracer}\]</div><p>where <span>$\bm{q}_c$</span> is the diffusive flux of <span>$c$</span> and <span>$F_c$</span> is an arbitrary source term. Oceananigans.jl permits arbitrary tracers and thus an arbitrary number of tracer  equations to be solved simultaneously with the momentum equations.</p><h2 id="Buoyancy-model-and-equations-of-state-1">Buoyancy model and equations of state<a class="docs-heading-anchor" href="#Buoyancy-model-and-equations-of-state-1" title="Permalink"></a></h2><p>The buoyancy model determines the relationship between tracers and the buoyancy <span>$b$</span> in the momentum equation.</p><h3 id="Buoyancy-tracer-1">Buoyancy tracer<a class="docs-heading-anchor" href="#Buoyancy-tracer-1" title="Permalink"></a></h3><p>The simplest buoyancy model uses buoyancy <span>$b$</span> itself as a tracer: <span>$b$</span> obeys the tracer conservation equation and is used directly in the momentum equations in the momentum equation.</p><h3 id="Seawater-buoyancy-1">Seawater buoyancy<a class="docs-heading-anchor" href="#Seawater-buoyancy-1" title="Permalink"></a></h3><p>For seawater buoyancy is, in general, modeled as a function of conservative temperature  <span>$\theta$</span>, absolute salinity <span>$S$</span>, and depth below the ocean surface <span>$d$</span> via</p><div>\[    b = - \frac{g}{\rho_0} \rho&#39; \left (\theta, S, d \right ) \, ,
    \tag{eq:seawater-buoyancy}\]</div><p>where <span>$g$</span> is gravitational acceleration, <span>$\rho_0$</span> is the reference density. The function <span>$\rho&#39;(\theta, S, d)$</span> in the seawater buoyancy relationship that links conservative temperature,  salinity, and depth to the density perturbation is called the <em>equation of state</em>. Both <span>$\theta$</span> and <span>$S$</span> obey the tracer conservation equation.</p><h4 id="Linear-equation-of-state-1">Linear equation of state<a class="docs-heading-anchor" href="#Linear-equation-of-state-1" title="Permalink"></a></h4><p>Buoyancy is determined from a linear equation of state via</p><div>\[    b = g \left ( \alpha_\theta \theta - \beta_S S \right ) \, ,\]</div><p>where <span>$g$</span> is gravitational acceleration, <span>$\alpha_\theta$</span> is the thermal expansion coefficient,  and <span>$\beta_S$</span> is the haline contraction coefficient.</p><h4 id="Nonlinear-equation-of-state-1">Nonlinear equation of state<a class="docs-heading-anchor" href="#Nonlinear-equation-of-state-1" title="Permalink"></a></h4><p>Buoyancy is determined by the simplified equations of state introduced by Roquet et al (2015).</p><h2 id="Coriolis-forces-1">Coriolis forces<a class="docs-heading-anchor" href="#Coriolis-forces-1" title="Permalink"></a></h2><p>The Coriolis model controls the manifestation of the term <span>$\bm{f} \times \bm{u}$</span> in the momentum equation.</p><h3 id="The-&quot;f-plane&quot;-approximation-1">The &quot;<span>$f$</span>-plane&quot; approximation<a class="docs-heading-anchor" href="#The-&quot;f-plane&quot;-approximation-1" title="Permalink"></a></h3><p>Under an <span>$f$</span>-plane approximation<sup class="footnote-reference"><a id="citeref-3" href="#footnote-3">[3]</a></sup> the reference frame in which  the momentum and tracer equations are are solved rotates at a constant rate around a  vertical axis, such that </p><div>\[    \bm{f} = f \bm{\hat z}\]</div><p>where <span>$f$</span> is constant and determined by the user. </p><h3 id="The-\\beta-plane-approximation-1">The <span>$\beta$</span>-plane approximation<a class="docs-heading-anchor" href="#The-\\beta-plane-approximation-1" title="Permalink"></a></h3><p>Under the <span>$\beta$</span>-plane approximation, the rotation axis is vertical as for the  <span>$f$</span>-plane approximation, but <span>$f$</span> is expanded in a Taylor series around a central latitude such that </p><div>\[    \bm{f} = \left ( f_0 + \beta y \right ) \bm{\hat z} \, ,\]</div><p>where <span>$f_0$</span> is the planetary vorticity at some central latitude, and <span>$\beta$</span> is the  planetary vorticity gradient. The <span>$\beta$</span>-plane model is not periodic in <span>$y$</span> and thus can be used only in domains that  are bounded in the <span>$y$</span>-direction.</p><h2 id="Turbulence-closures-1">Turbulence closures<a class="docs-heading-anchor" href="#Turbulence-closures-1" title="Permalink"></a></h2><p>The turbulence closure selected by the user determines the form of stress divergence  <span>$\bm{\nabla} \bm{\cdot} \bm{\tau}$</span> and diffusive flux divergence  <span>$\bm{\nabla} \bm{\cdot} \bm{q}_c$</span> in the momentum and tracer conservation equations.</p><h3 id="Constant-isotropic-diffusivity-1">Constant isotropic diffusivity<a class="docs-heading-anchor" href="#Constant-isotropic-diffusivity-1" title="Permalink"></a></h3><p>In a constant isotropic diffusivity model, the kinematic stress tensor is defned</p><div>\[\tau_{ij} = - \nu \Sigma_{ij} \, ,\]</div><p>where <span>$\nu$</span> is a constant viscosity and  <span>$\Sigma_{ij} \equiv \tfrac{1}{2} \left ( u_{i, j} + u_{j, i} \right )$</span> is the strain-rate  tensor. The divergence of <span>$\bm{\tau}$</span> is then</p><div>\[\bm{\nabla} \bm{\cdot} \bm{\tau} = -\nu \bm{\nabla}^2 \bm{u} \, .\]</div><p>Similarly, the diffusive tracer flux is <span>$\bm{q}_c = - \kappa \bm{\nabla} c$</span> for tracer  diffusivity <span>$\kappa$</span>, and the diffusive tracer flux divergence is</p><div>\[\bm{\nabla} \bm{\cdot} \bm{q}_c = - \kappa \bm{\nabla}^2 c \, .\]</div><p>Each tracer may have a unique diffusivity <span>$\kappa$</span>.</p><h3 id="Constant-anisotropic-diffusivity-1">Constant anisotropic diffusivity<a class="docs-heading-anchor" href="#Constant-anisotropic-diffusivity-1" title="Permalink"></a></h3><p>In Oceananigans.jl, a constant anisotropic diffusivity implies a constant tensor  diffusivity <span>$\nu_{j k}$</span> and stress <span>$\bm{\tau}_{ij} = \nu_{j k} u_{i, k}$</span> with non-zero  components <span>$\nu_{11} = \nu_{22} = \nu_h$</span> and <span>$\nu_{33} = \nu_v$</span>. With this form the kinematic stress divergence becomes</p><div>\[\bm{\nabla} \bm{\cdot} \bm{\tau} = - \left [ \nu_h \left ( \partial_x^2 + \partial_y^2 \right ) 
                                    + \nu_v \partial_z^2 \right ] \bm{u} \, ,\]</div><p>and diffusive flux divergence</p><div>\[\bm{\nabla} \bm{\cdot} \bm{q}_c = - \left [ \kappa_{h} \left ( \partial_x^2 + \partial_y^2 \right ) 
                                    + \kappa_{v} \partial_z^2 \right ] c \, .\]</div><p>in terms of the horizontal viscosities and diffusivities <span>$\nu_h$</span> and <span>$\kappa_{h}$</span> and the  vertical viscosity and diffusivities <span>$\nu_v$</span> and <span>$\kappa_{v}$</span>. Each tracer may have a unique diffusivity components <span>$\kappa_h$</span> and <span>$\kappa_v$</span>.</p><h3 id="Constant-anisotropic-biharmonic-diffusivity-1">Constant anisotropic biharmonic diffusivity<a class="docs-heading-anchor" href="#Constant-anisotropic-biharmonic-diffusivity-1" title="Permalink"></a></h3><p>In Oceananigans.jl, a constant anisotropic biharmonic diffusivity implies a constant tensor  diffusivity <span>$\nu_{j k}$</span> and stress <span>$\bm{\tau}_{ij} = \nu_{j k} \partial_k^3 u_i$</span> with non-zero  components <span>$\nu_{11} = \nu_{22} = \nu_h$</span> and <span>$\nu_{33} = \nu_v$</span>. With this form the kinematic stress divergence becomes</p><div>\[\bm{\nabla} \bm{\cdot} \bm{\tau} = - \left [ \nu_h \left ( \partial_x^2 + \partial_y^2 \right )^2 
                                    + \nu_v \partial_z^4 \right ] \bm{u} \, ,\]</div><p>and diffusive flux divergence</p><div>\[\bm{\nabla} \bm{\cdot} \bm{q}_c = - \left [ \kappa_{h} \left ( \partial_x^2 + \partial_y^2 \right )^2 
                                    + \kappa_{v} \partial_z^4 \right ] c \, .\]</div><p>in terms of the horizontal biharmonic viscosities and diffusivities <span>$\nu_h$</span> and <span>$\kappa_{h}$</span> and the  vertical biharmonic viscosity and diffusivities <span>$\nu_v$</span> and <span>$\kappa_{v}$</span>. Each tracer may have a unique diffusivity components <span>$\kappa_h$</span> and <span>$\kappa_v$</span>.</p><h3 id="Smagorinsky-Lilly-turbulence-closure-1">Smagorinsky-Lilly turbulence closure<a class="docs-heading-anchor" href="#Smagorinsky-Lilly-turbulence-closure-1" title="Permalink"></a></h3><p>In the turbulence closure proposed by Lilly (1962) and Smagorinsky (1963),  the subgrid stress associated with unresolved turbulent motions is modeled diffusively via</p><div>\[\tau_{ij} = \nu_e \Sigma_{ij} \, ,\]</div><p>where <span>$\Sigma_{ij} = \tfrac{1}{2} \left ( u_{i, j} + u_{j, i} \right )$</span> is the resolved  strain rate.  The eddy viscosity is given by</p><div>\[    \nu_e = \left ( C \Delta_f \right )^2 \sqrt{ \Sigma^2 } \, \Upsilon(Ri) + \nu \, ,
    \tag{eq:smagorinsky-viscosity}\]</div><p>where <span>$\Delta_f$</span> is the &quot;filter width&quot; associated with the finite volume grid spacing,  <span>$C$</span> is a user-specified model constant, <span>$\Sigma^2 \equiv \Sigma_{ij} \Sigma{ij}$</span>, and  <span>$\nu$</span> is a constant isotropic background viscosity. The factor <span>$\Upsilon(Ri)$</span> reduces <span>$\nu_e$</span> in regions of  strong stratification where the resolved gradient Richardson number  <span>$Ri \equiv N^2 / \Sigma^2$</span> is large via</p><div>\[    \Upsilon(Ri) = \sqrt{1 - \min \left ( 1, C_b N^2 / \Sigma^2 \right )} \, ,\]</div><p>where <span>$N^2 = \max \left (0, \partial_z b \right )$</span> is the squared buoyancy frequency for stable stratification with <span>$\partial_z b &gt; 0$</span> and <span>$C_b$</span> is a user-specified constant. Roughly speaking, the filter width for the Smagorinsky-Lilly closure is taken as</p><div>\[\Delta_f(\bm{x}) = \left ( \Delta x \Delta y \Delta z \right)^{1/3} \, ,\]</div><p>where <span>$\Delta x$</span>, <span>$\Delta y$</span>, and <span>$\Delta z$</span> are the grid spacing in the  <span>$\bm{\hat x}$</span>, <span>$\bm{\hat y}$</span>, and <span>$\bm{\hat z}$</span> directions at location <span>$\bm{x} = (x, y, z)$</span>.</p><p>The effect of subgrid turbulence on tracer mixing is also modeled diffusively via</p><div>\[\bm{q}_c = \kappa_e \bm{\nabla} c \, ,\]</div><p>where the eddy diffusivity <span>$\kappa_e$</span> is</p><div>\[\kappa_e = \frac{\nu_e - \nu}{Pr} + \kappa \, ,\]</div><p>where <span>$Pr$</span> is a turbulent Prandtl number and <span>$\kappa$</span> is a constant isotropic background diffusivity. Both <span>$Pr$</span> and <span>$\kappa$</span> may be set independently for each tracer.</p><h3 id="Anisotropic-minimum-dissipation-(AMD)-turbulence-closure-1">Anisotropic minimum dissipation (AMD) turbulence closure<a class="docs-heading-anchor" href="#Anisotropic-minimum-dissipation-(AMD)-turbulence-closure-1" title="Permalink"></a></h3><p>Oceananigans.jl uses the anisotropic minimum dissipation (AMD) model proposed by  Verstappen18 and described and tested by Vreugdenhil18.  The AMD model uses an eddy diffusivity hypothesis similar the Smagorinsky-Lilly model. In the AMD model, the eddy viscosity and diffusivity for each tracer are defined in terms  of eddy viscosity and diffusivity \emph{predictors} <span>$\nu_e^\dagger$</span> and <span>$\kappa_e^\dagger$</span>, such that</p><div>\[    \nu_e = \max \left ( 0, \nu_e^\dagger \right ) + \nu
    \quad \text{and} \quad
    \kappa_e = \max \left ( 0, \kappa_e^\dagger \right ) + \kappa\]</div><p>to ensure that <span>$\nu_e \ge 0$</span> and <span>$\kappa_e \ge 0$</span>, where <span>$\nu$</span> and <span>$\kappa$</span> are the  constant isotropic background viscosity and diffusivities for each tracer. The eddy viscosity predictor is</p><div>\[    \tag{eq:nu-dagger}
    \nu_e^\dagger = -(C \Delta_f)^2
    \frac
        {\left( \hat{\partial}_k \hat{u}_i \right) \left( \hat{\partial}_k \hat{u}_j \right) \hat{\Sigma}_{ij}
        + C_b \hat{\delta}_{i3} \left( \hat{\partial}_k \hat{u_i} \right) \hat{\partial}_k b}
        {\left( \hat{\partial}_l \hat{u}_m \right) \left( \hat{\partial}_l \hat{u}_m \right)}\]</div><p>while the eddy diffusivity predictor for tracer <span>$c$</span> is</p><div>\[    \tag{eq:kappa-dagger}
    \kappa_e^\dagger = -(C \Delta_f)^2
    \frac
        {\left( \hat{\partial}_k \hat{u}_i \right) \left( \hat{\partial}_k c \right) \hat{\partial}_i c}
        {\left( \hat{\partial}_l c \right) \left( \hat{\partial}_l c \right)} \, .\]</div><p>In the definitions of the eddy viscosity and eddy diffusivity predictor, <span>$C$</span> and <span>$C_b$</span> are  user-specified model constants, <span>$\Delta_f$</span> is a &quot;filter width&quot; associated with the finite volume  grid spacing, and the hat decorators on partial derivatives, velocities, and the Kronecker  delta <span>$\hat \delta_{i3}$</span> are defined such that</p><div>\[    \hat \partial_i \equiv \Delta_i \partial_i, \qquad
    \hat{u}_i(x, t) \equiv \frac{u_i(x, t)}{\Delta_i}, \quad \text{and} \quad
    \hat{\delta}_{i3} \equiv \frac{\delta_{i3}}{\Delta_3} \, .\]</div><p>A velocity gradient, for example, is therefore  <span>$\hat{\partial}_i \hat{u}_j(x, t) = \frac{\Delta_i}{\Delta_j} \partial_i u_j(x, t)$</span>,  while the normalized strain tensor is</p><div>\[    \hat{\Sigma}_{ij} =
        \frac{1}{2} \left[ \hat{\partial}_i \hat{u}_j(x, t) + \hat{\partial}_j \hat{u}_i(x, t) \right] \, .\]</div><p>The filter width <span>$\Delta_f$</span> in that appears in the viscosity and diffusivity predictors is taken as the square root of the harmonic mean of the squares of the filter widths in  each direction:</p><div>\[    \frac{1}{\Delta_f^2} = \frac{1}{3} \left(   \frac{1}{\Delta x^2} 
                                              + \frac{1}{\Delta y^2} 
                                              + \frac{1}{\Delta z^2} \right) \, .\]</div><p>The constant <span>$C_b$</span> permits the &quot;buoyancy modification&quot; term it multiplies to be omitted  from a calculation. By default we use the model constants <span>$C=1/12$</span> and <span>$C_b=0$</span>.</p><h2 id="Surface-gravity-waves-and-the-Craik-Leibovich-approximation-1">Surface gravity waves and the Craik-Leibovich approximation<a class="docs-heading-anchor" href="#Surface-gravity-waves-and-the-Craik-Leibovich-approximation-1" title="Permalink"></a></h2><p>In Oceananiagns.jl, users model the effects of surface waves by specifying spatial and temporal gradients of the Stokes drift velocity field. At the moment, only uniform unidirectional Stokes drift fields are supported, in which case</p><div>\[    \bm{u}^S = u^S(z, t) \hat{\bm{x}} + v^S(z, t) \hat{\bm{y}} \, .\]</div><p>Surface waves are modeled in Oceananigans.jl by the Craik-Leibovich approximation, which governs interior motions under a surface gravity wave field that have been time- or phase-averaged over the rapid oscillations of the surface waves. The oscillatory vertical and horizontal motions associated with surface waves themselves, therefore, are not present in the resolved velocity field <span>$\bm{u}$</span>, and only the steady,  averaged effect of surface waves that manifests over several or more wave oscillations are modeled.</p><p>In Oceananigans.jl with surface waves, the resolved velocity field <span>$\bm{u}$</span> is the Lagrangian-mean  velocity field. The Lagrangian-mean velocity field at a particular location <span>$(x, y, z)$</span> is average velocity of a  fluid particle whose average position is <span>$(x, y, z)$</span> at time <span>$t$</span>. The average position of a fluid particle <span>$\bm{\xi}(t) = (\xi, \eta, \zeta)$</span> is thus governed by</p><div>\[    \partial_t \bm{\xi} + \bm{u}(\bm{\xi}, t) \bm{\cdot} \bm{\nabla} \bm{\xi} = \bm{u}(\bm{\xi}, t) \, ,\]</div><p>which is the same relationship that holds when surface waves are not present and <span>$\bm{u}$</span> ceases to be an averaged velocity field. The simplicity of the governing equations for Lagrangian-mean momentum is the main reason we use a Lagrangian-mean formulation in Oceananigans.jl, rather than an Eulerian-mean formulation:  for example, the tracer conservation equation is unchanged by the inclusion of surface wave effects. Moreover, because the effect of surface waves manifests either as a bulk forcing of  Lagrangian-mean momentum or as a modification to the effective background rotation rate of  the interior fluid similar to any bulk forcing or Coriolis force, we do not explicitly include the  effects of surface waves in turbulence closures that model the effects of subgrid turbulence. More specifically, the effect of steady surface waves does not effect the conservation of  Lagrangian-mean turbulent kinetic energy.</p><p>The Lagrangian-mean velocity field <span>$\bm{u}$</span> contrasts with the Eulerian-mean velocity field <span>$\bm{u}^E$</span>,  which is the fluid velocity averaged at the fixed Eulerian position <span>$(x, y, z)$</span>. The surface wave Stokes drift field supplied by the user is, in fact, defined by the difference between the Eulerian- and Lagrangian-mean velocity:</p><div>\[    \bm{u}^S \equiv \bm{u} - \bm{u}^E \, .\]</div><p>The Stokes drift velocity field is typically prescribed for idealized scenarios, or determined from a wave model for the evolution of surface waves under time-dependent atmospheric winds in more realistic cases.</p><h2 id="Boundary-conditions-1">Boundary conditions<a class="docs-heading-anchor" href="#Boundary-conditions-1" title="Permalink"></a></h2><p>In Oceananigans.jl the user may impose \textit{no-penetration}, \textit{flux},  \textit{gradient} (Neumann), and \textit{value} (Dirichlet) boundary conditions in bounded,  non-periodic directions. Note that the only boundary condition available for a velocity field normal to the bounded  direction is \textit{no-penetration}.</p><h3 id="Flux-boundary-conditions-1">Flux boundary conditions<a class="docs-heading-anchor" href="#Flux-boundary-conditions-1" title="Permalink"></a></h3><p>A flux boundary condition prescribes flux of a quantity normal to the boundary.  For a tracer <span>$c$</span> this corresponds to prescribing </p><div>\[q_c \, |_b \equiv \bm{q}_c \bm{\cdot} \hat{\bm{n}} \, |_{\partial \Omega_b} \, , \]</div><p>where <span>$\partial \Omega_b$</span> is an external boundary.</p><h3 id="Gradient-(Neumann)-boundary-condition-1">Gradient (Neumann) boundary condition<a class="docs-heading-anchor" href="#Gradient-(Neumann)-boundary-condition-1" title="Permalink"></a></h3><p>A gradient boundary condition prescribes the gradient of a field normal to the boundary.  For a tracer <span>$c$</span> this prescribes </p><div>\[\gamma \equiv \bm{\nabla} c \bm{\cdot} \hat{\bm{n}} \, |_{\partial \Omega_b} \, .\]</div><h3 id="Value-(Dirichlet)-boundary-condition-1">Value (Dirichlet) boundary condition<a class="docs-heading-anchor" href="#Value-(Dirichlet)-boundary-condition-1" title="Permalink"></a></h3><p>A value boundary condition prescribes the value of a field on a boundary; for a tracer this  prescribes </p><div>\[c_b \equiv c \, |_{\partial \Omega_b} \, .\]</div><h3 id="No-penetration-boundary-condition-1">No penetration boundary condition<a class="docs-heading-anchor" href="#No-penetration-boundary-condition-1" title="Permalink"></a></h3><p>A no penetration boundary condition prescribes the velocity component normal to a boundary to be 0, so that</p><div>\[\bm{\hat{n}} \bm{\cdot} \bm{u} \, |_{\partial \Omega_b} = 0 \, .\]</div><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>Named after Boussinesq (1903) although used earlier by Oberbeck (1879), the Boussinesq   approximation neglects density differences in the momentum equation except when associated    with the gravitational term. It is an accurate approximation for many flows, and especially    so for oceanic flows where density differences are very small. See Vallis (2017, section 2.4)    for an oceanographic introduction to the Boussinesq equations and Vallis (2017, Section 2.A)    for an asymptotic derivation. See Kundu (2015, Section 4.9) for an engineering    introduction.</li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a>Incompressible fluids do not support acoustic waves.</li><li class="footnote" id="footnote-3"><a class="tag is-link" href="#citeref-3">3</a>The <span>$f$</span>-plane approximation is used to model the effects of Earth&#39;s rotation on    anisotropic fluid motion in a plane tangent to the Earth&#39;s surface. In this case, <span>$\bm{f}$</span> is    <code>math       \bm{f} \approx \frac{4 \pi}{\text{day}} \sin \varphi \bm{\hat z} \, , $</code>   where <span>$\phi$</span> is latitude and the Earth&#39;s rotation rate is approximately <span>$2 \pi / \text{day}$</span>.   This approximation neglects the vertical component of Earth&#39;s rotation vector at <span>$\varphi$</span>.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../generated/internal_wave/">« Internal wave</a><a class="docs-footer-nextpage" href="../pressure_decomposition/">Pressure decomposition »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 4 November 2019 14:03">Monday 4 November 2019</span>. Using Julia version 1.2.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
