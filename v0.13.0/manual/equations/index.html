<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Continuous equations · Oceananigans.jl</title><link rel="canonical" href="https://climate-machine.github.io/Oceananigans.jl/latest/manual/equations/index.html"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.8.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.8.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.8.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><link href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Oceananigans.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li class="is-active"><a class="tocitem" href>Continuous equations</a><ul class="internal"><li><a class="tocitem" href="#Rotating-Boussinesq-equations-1"><span>Rotating Boussinesq equations</span></a></li><li><a class="tocitem" href="#Hydrostatic-and-non-hydrostatic-momentum-equations-1"><span>Hydrostatic and non-hydrostatic momentum equations</span></a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Numerical methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../overview/">Overview</a></li><li><a class="tocitem" href="../finite_volume/">Finite volume method</a></li><li><a class="tocitem" href="../staggered_grid/">Staggered grid</a></li><li><a class="tocitem" href="../fractional_step/">Fractional step method</a></li><li><a class="tocitem" href="../time_stepping/">Time stepping</a></li><li><a class="tocitem" href="../spatial_operators/">Spatial operators</a></li><li><a class="tocitem" href="../poisson_solvers/">Poisson solvers</a></li><li><a class="tocitem" href="../boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../turbulence_closures/">Turbulence closures</a></li><li><a class="tocitem" href="../large_eddy_simulation/">Large eddy simulation</a></li></ul></li><li><a class="tocitem" href="../model_setup/">Model setup</a></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/simple_diffusion/">One-dimensional diffusion</a></li><li><a class="tocitem" href="../../generated/two_dimensional_turbulence/">Two-dimensional turbulence</a></li><li><a class="tocitem" href="../../generated/internal_wave/">Internal wave</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-5" type="checkbox"/><label class="tocitem" for="menuitem-2-5"><span class="docs-label">Verification</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../verification/taylor_green_vortex/">Taylor-Green vortex</a></li><li><a class="tocitem" href="../../verification/lid_driven_cavity/">Lid-driven cavity</a></li><li><a class="tocitem" href="../../verification/free_convection/">Free convection</a></li><li><a class="tocitem" href="../../verification/stratified_couette_flow/">Stratified Couette flow</a></li></ul></li></ul></li><li><a class="tocitem" href="../../gallery/">Gallery</a></li><li><a class="tocitem" href="../../benchmarks/">Benchmarks</a></li><li><a class="tocitem" href="../../library/">Library</a></li><li><a class="tocitem" href="../../subject_index/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Continuous equations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Continuous equations</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/climate-machine/Oceananigans.jl/blob/master/docs/src/manual/equations.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Continuous-equations-1">Continuous equations<a class="docs-heading-anchor" href="#Continuous-equations-1" title="Permalink"></a></h1><p>The governing equations solved by \texttt{Oceananigans.jl} are the rotating Navier-Stokes equations describing viscous fluid flow with the Boussinesq approximation.<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup> The resulting mass conservation equation imposes that the fluid flow is incompressible.<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup></p><h2 id="Rotating-Boussinesq-equations-1">Rotating Boussinesq equations<a class="docs-heading-anchor" href="#Rotating-Boussinesq-equations-1" title="Permalink"></a></h2><p>The rotating Boussinesq equations can be written as</p><div>\[  \D{\bm{u}}{t} + 2\bm{\Omega}\times\bm{u} + \frac{1}{\rho_0} \grad p - \div{\nu \grad \bm{u}}
    + g \frac{\rho\prime}{\rho_0} \hat{\bm{k}} - \bm{F} = 0 \label{eq:momentum}\]</div><p>along with the mass conservation equation</p><div>\[    \grad \cdot \bm{u} = 0  \label{eq:continuity}\]</div><p>where <span>$\uvec{i}, \uvec{j}, \uvec{k}$</span> are the standard Cartesian basis vectors, <span>$\bm{u} = (u, v, w)$</span> is the fluid flow velocity field, <span>$\bm{\Omega}$</span> is the rotation vector, <span>$p$</span> is the pressure, <span>$\nu$</span> is the kinematic viscosity, <span>$g$</span> is the gravitational acceleration, <span>$\rho_0$</span> is a reference density describing the base state of the Boussinesq fluid whereas <span>$\rho\prime = \rho - \rho_0$</span> denotes density variations, and <span>$F = (F_u, F_v, F_w)$</span> includes forcing terms (or rather, the sources and sinks). <span>$\D{\bm{q}}{t} = \p{\bm{q}}{t} + \bm{u}\cdot\grad\bm{q}$</span> is the  material derivative and <span>$\grad = (\partial_x, \partial_y, \partial_z)$</span> is the del operator.</p><p>Tracer quantities <span>$c$</span> such as temperature and salinity satisfy an advection-diffusion equation</p><div>\[\D{c}{t} - \div{\kappa_c \grad c} + F_c = 0  \label{eq:tracer}\]</div><p>where <span>$c$</span> is any tracer, <span>$\kappa_c$</span> is the tracer diffusivity, and <span>$F_c$</span> is a forcing term.</p><p>Tracer quantities, for example temperature <span>$T$</span> and salinity <span>$S$</span> in oceanographic applications, are related to the density <span>$\rho$</span> and pressure <span>$p$</span> by an appropriate equation of state</p><div>\[  \rho = \rho(T, S, p)\]</div><p>which may take multiple forms.</p><p>In order to discretize and discuss the equations, it will be helpful to expand out the material derivative and write out the individual components of the momentum equation \eqref{eq:momentum} and tracer equation \eqref{eq:tracer}.</p><p>We can write equations for the time derivatives<sup class="footnote-reference"><a id="citeref-3" href="#footnote-3">[3]</a></sup> of <span>$u$</span>, <span>$v$</span>, <span>$w$</span>, and <span>$c$</span></p><div>\[\begin{aligned}
  \partial_t u &amp;= -\bm{u}\cdot\grad u + fv - \partial_x \phi + \div{\nu \grad u}      + F_u \label{eq:xMomentum} \\
  \partial_t v &amp;= -\bm{u}\cdot\grad v - fu - \partial_y \phi + \div{\nu \grad v}      + F_v \label{eq:yMomentum} \\
  \partial_t w &amp;= -\bm{u}\cdot\grad w      - \partial_z \phi + \div{\nu \grad w} + b  + F_w \label{eq:zMomentum} \\
  \partial_t c &amp;= -\bm{u}\cdot\grad c                        + \div{\kappa_c \grad c} + F_c \label{eq:tracer2}
\end{aligned}\]</div><p>where we have rewritten the pressure gradient term as the gradient of the kinematic pressure <span>$\phi = p/\rho_0$</span> and <span>$b = -g\rho\prime/\rho_0$</span> is the buoyancy. We have also rewritten <span>$2\bm{\Omega}\times\bm{u} = -fv \bm{\hat{i}} + fu \bm{\hat{j}}$</span> where <span>$f$</span> is the Coriolis parameter which on a rotating sphere can be expressed as <span>$f = 2 \Omega \sin \varphi$</span> where <span>$\Omega$</span> is the rotation rate of the sphere, and <span>$\varphi$</span> is the latitude.<sup class="footnote-reference"><a id="citeref-4" href="#footnote-4">[4]</a></sup></p><h2 id="Hydrostatic-and-non-hydrostatic-momentum-equations-1">Hydrostatic and non-hydrostatic momentum equations<a class="docs-heading-anchor" href="#Hydrostatic-and-non-hydrostatic-momentum-equations-1" title="Permalink"></a></h2><p>As a practical matter to allow the choice between evolving a hydrostatic and non-hydrostatic set of equations, we split the kinematic pressure term into hydrostatic and non-hydrostatic parts,</p><div>\[  \phi(x, y, z) = \phi_{HY}(x, y, z) + \phi_{NH}(x, y, z)\]</div><p>We then note that in the hydrostatic approximation, the pressure and buoyancy terms in the vertical momentum equation are in balance </p><div>\[  \partial_z \phi_{HY} = -b\]</div><p>and so the <span>$-\grad\phi + b\hat{\bm{k}}$</span> term in the momentum equation can be written as</p><div>\[    -\grad\phi + b\hat{\bm{k}}
    = - \grad\phi_{NH} - \grad\phi_{HY} + b
    = - \grad\phi_{NH} - \partial_x \phi_{HY}^\prime \hat{\bm{i}} - \partial_y \phi_{HY}^\prime \hat{\bm{j}}\]</div><p>where <span>$\partial_x \phi_{HY} = \partial_x \phi_{HY}^\prime$</span> and <span>$\partial_y \phi_{HY} = \partial_y \phi_{HY}^\prime$</span> as <span>$\phi_{HY}^\prime$</span> denotes the <em>hydrostatic pressure anomaly</em>, which is the component of the pressure  associated with buoyancy.</p><p>Thus the components of the momentum equation \eqref{eq:xMomentum}–\eqref{eq:zMomentum} can be written as</p><div>\[\begin{aligned}
  \partial_t u &amp;= -\bm{u}\cdot\grad u + fv - \partial_x (\phi_{NH} + \phi_{HY}^\prime) + \div{\nu \grad u} + F_u \\
  \partial_t v &amp;= -\bm{u}\cdot\grad v - fu - \partial_y (\phi_{NH} + \phi_{HY}^\prime) + \div{\nu \grad v} + F_v \\
  \partial_t w &amp;= -\bm{u}\cdot\grad w      - \partial_z  \phi_{NH}                  + \div{\nu \grad w} + F_w 
\end{aligned}\]</div><p>The non-hydrostatic pressure <span>$\phi_{NH}$</span> is associated with small-scale motions that are not in hydrostatic balance and is numerically responsible for enforcing incompressibility, and thus mass conservation.</p><p>Note that we have not invoked the hydrostatic approximation. We are still dealing with a non-hydrostatic set of  equations. We just made use of the hydrostatic approximation to manipulate the equations such that if we want to  evolve a hydrostatic set of equations we can now just neglect the <span>$\grad\phi_{NH}$</span> terms (or multiply them by zero).  So it becomes simple to switch between hydrostatic and non-hydrostatic modes.</p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>Named after \citet{Boussinesq1903} although used earlier by \citet{Oberbeck1879}, the Boussinesq approximation neglects density differences in the momentum equation except when associated with the gravitational term. It is an accurate approximation for many flows, and especially so for oceanic flows where density differences  are very small. See \citet[\S2.4]{Vallis17} for an oceanographic introduction to the Boussinesq equations and \citet[\S2.A]{Vallis17} for an asymptotic derivation. See \citet[\S4.9]{Kundu15} for an engineering introduction.}</li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a>Incompressibility rules out density and pressure waves like sound or shock waves.</li><li class="footnote" id="footnote-3"><a class="tag is-link" href="#citeref-3">3</a>In the geophysical sciences, the time derivatives are sometimes called the tendencies.</li><li class="footnote" id="footnote-4"><a class="tag is-link" href="#citeref-4">4</a><p>It is important to note here that the full expression for the Coriolis force is given by  $ 2\bm{\Omega}\times\bm{u} = (2\Omega w \cos\varphi - 2\Omega v \sin \varphi) \hat{\bm{i}}</p><ul><li>2\Omega u \sin\varphi \hat{\bm{j}} - 2\Omega u \cos\varphi \hat{\bm{k}} $</li></ul><p>however the Coriolis terms involving the vertical velocity and <span>$\cos\varphi$</span> term are neglected due to their small contribution in geophysical fluid dynamics on Earth. This is termed the \emph{traditional approximation} and must be taken with the \emph{shallow-fluid approximation}, which assumes the depth of the fluid is much shallower than the radius of the sphere on which it evolves, otherwise conservation of energy and angular momentum is not guaranteed. See \citet[\S2.2.4]{Vallis17} for an introductory discussion of these approximations, and \citet{Marshall97HY,White05} for a more detailed discussion.</p></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../overview/">Overview »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 23 October 2019 03:46">Wednesday 23 October 2019</span>. Using Julia version 1.2.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
