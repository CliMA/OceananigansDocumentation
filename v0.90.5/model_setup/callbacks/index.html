<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Callbacks · Oceananigans.jl</title><meta name="title" content="Callbacks · Oceananigans.jl"/><meta property="og:title" content="Callbacks · Oceananigans.jl"/><meta property="twitter:title" content="Callbacks · Oceananigans.jl"/><meta name="description" content="Documentation for Oceananigans.jl."/><meta property="og:description" content="Documentation for Oceananigans.jl."/><meta property="twitter:description" content="Documentation for Oceananigans.jl."/><meta property="og:url" content="https://clima.github.io/OceananigansDocumentation/stable/model_setup/callbacks/"/><meta property="twitter:url" content="https://clima.github.io/OceananigansDocumentation/stable/model_setup/callbacks/"/><link rel="canonical" href="https://clima.github.io/OceananigansDocumentation/stable/model_setup/callbacks/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Oceananigans.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../quick_start/">Quick start</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/one_dimensional_diffusion/">One-dimensional diffusion</a></li><li><a class="tocitem" href="../../generated/two_dimensional_turbulence/">Two-dimensional turbulence</a></li><li><a class="tocitem" href="../../generated/internal_wave/">Internal wave</a></li><li><a class="tocitem" href="../../generated/convecting_plankton/">Convecting plankton</a></li><li><a class="tocitem" href="../../generated/ocean_wind_mixing_and_convection/">Ocean wind mixing and convection</a></li><li><a class="tocitem" href="../../generated/langmuir_turbulence/">Langmuir turbulence</a></li><li><a class="tocitem" href="../../generated/baroclinic_adjustment/">Baroclinic adjustment</a></li><li><a class="tocitem" href="../../generated/kelvin_helmholtz_instability/">Kelvin-Helmholtz instability</a></li><li><a class="tocitem" href="../../generated/shallow_water_Bickley_jet/">Shallow water Bickley jet</a></li><li><a class="tocitem" href="../../generated/horizontal_convection/">Horizontal convection</a></li><li><a class="tocitem" href="../../generated/tilted_bottom_boundary_layer/">Tilted bottom boundary layer</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Physics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../physics/notation/">Coordinate system and notation</a></li><li><a class="tocitem" href="../../physics/boussinesq/">Boussinesq approximation</a></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label"><code>NonhydrostaticModel</code></span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../physics/nonhydrostatic_model/">Nonhydrostatic model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label"><code>HydrostaticFreeSurfaceModel</code></span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../physics/hydrostatic_free_surface_model/">Hydrostatic model with a free surface</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-5" type="checkbox"/><label class="tocitem" for="menuitem-4-5"><span class="docs-label"><code>ShallowWaterModel</code></span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../physics/shallow_water_model/">Shallow water model</a></li></ul></li><li><a class="tocitem" href="../../physics/boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../../physics/buoyancy_and_equations_of_state/">Buoyancy models and equations of state</a></li><li><a class="tocitem" href="../../physics/coriolis_forces/">Coriolis forces</a></li><li><a class="tocitem" href="../../physics/turbulence_closures/">Turbulence closures</a></li><li><a class="tocitem" href="../../physics/surface_gravity_waves/">Surface gravity waves and the Craik-Leibovich approximation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Numerical implementation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../numerical_implementation/finite_volume/">Finite volume method</a></li><li><a class="tocitem" href="../../numerical_implementation/spatial_operators/">Spatial operators</a></li><li><a class="tocitem" href="../../numerical_implementation/pressure_decomposition/">Pressure decomposition</a></li><li><a class="tocitem" href="../../numerical_implementation/time_stepping/">Time stepping</a></li><li><a class="tocitem" href="../../numerical_implementation/boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../../numerical_implementation/elliptic_solvers/">Elliptic solvers</a></li><li><a class="tocitem" href="../../numerical_implementation/large_eddy_simulation/">Large eddy simulation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Model setup</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../overview/">Overview</a></li><li><a class="tocitem" href="../architecture/">Architecture</a></li><li><a class="tocitem" href="../number_type/">Number type</a></li><li><a class="tocitem" href="../grids/">Grid</a></li><li><a class="tocitem" href="../clock/">Clock</a></li><li><a class="tocitem" href="../coriolis/">Coriolis (rotation)</a></li><li><a class="tocitem" href="../tracers/">Tracers</a></li><li><a class="tocitem" href="../buoyancy_and_equation_of_state/">Buoyancy models and equation of state</a></li><li><a class="tocitem" href="../boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../forcing_functions/">Forcing functions</a></li><li><a class="tocitem" href="../background_fields/">Background fields</a></li><li><a class="tocitem" href="../turbulent_diffusivity_closures_and_les_models/">Turbulent diffusivity closures and LES models</a></li><li><a class="tocitem" href="../lagrangian_particles/">Lagrangian particles</a></li><li><a class="tocitem" href="../diagnostics/">Diagnostics</a></li><li><a class="tocitem" href="../output_writers/">Output writers</a></li><li><a class="tocitem" href="../checkpointing/">Checkpointing</a></li><li><a class="tocitem" href="../setting_initial_conditions/">Setting initial conditions</a></li></ul></li><li><a class="tocitem" href="../../simulation_tips/">Simulation tips</a></li><li><a class="tocitem" href="../../contributing/">Contributor&#39;s guide</a></li><li><a class="tocitem" href="../../gallery/">Gallery</a></li><li><a class="tocitem" href="../../references/">References</a></li><li><input class="collapse-toggle" id="menuitem-11" type="checkbox"/><label class="tocitem" for="menuitem-11"><span class="docs-label">Appendix</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../appendix/staggered_grid/">Staggered grid</a></li><li><a class="tocitem" href="../../appendix/fractional_step/">Fractional step method</a></li><li><a class="tocitem" href="../../appendix/convergence_tests/">Convergence tests</a></li><li><a class="tocitem" href="../../appendix/benchmarks/">Performance benchmarks</a></li><li><a class="tocitem" href="../../appendix/library/">Library</a></li><li><a class="tocitem" href="../../appendix/function_index/">Function index</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Callbacks</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Callbacks</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/Oceananigans.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/Oceananigans.jl/blob/main/docs/src/model_setup/callbacks.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Callbacks"><a class="docs-heading-anchor" href="#Callbacks">Callbacks</a><a id="Callbacks-1"></a><a class="docs-heading-anchor-permalink" href="#Callbacks" title="Permalink"></a></h1><p>Callbacks can be used to execute an arbitrary user defined function on the simulation at user  defined times, or between every time stepper sub-step for <code>state_callbacks</code>.</p><p>For example, we can specify a callback which displays the run time every 2 iterations:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using Oceananigans</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; model = NonhydrostaticModel(grid=RectilinearGrid(size=(1, 1, 1), extent=(1, 1, 1)))</code><code class="nohighlight hljs ansi" style="display:block;">NonhydrostaticModel{CPU, RectilinearGrid}(time = 0 seconds, iteration = 0)
├── grid: 1×1×1 RectilinearGrid{Float64, Periodic, Periodic, Bounded} on CPU with 3×3×3 halo
├── timestepper: QuasiAdamsBashforth2TimeStepper
├── tracers: ()
├── closure: Nothing
├── buoyancy: Nothing
└── coriolis: Nothing</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; simulation = Simulation(model, Δt=1, stop_iteration=10)</code><code class="nohighlight hljs ansi" style="display:block;">Simulation of NonhydrostaticModel{CPU, RectilinearGrid}(time = 0 seconds, iteration = 0)
├── Next time step: 1 second
├── Elapsed wall time: 0 seconds
├── Wall time per iteration: NaN days
├── Stop time: Inf days
├── Stop iteration : 10.0
├── Wall time limit: Inf
├── Callbacks: OrderedDict with 4 entries:
│   ├── stop_time_exceeded =&gt; Callback of stop_time_exceeded on IterationInterval(1)
│   ├── stop_iteration_exceeded =&gt; Callback of stop_iteration_exceeded on IterationInterval(1)
│   ├── wall_time_limit_exceeded =&gt; Callback of wall_time_limit_exceeded on IterationInterval(1)
│   └── nan_checker =&gt; Callback of NaNChecker for u on IterationInterval(100)
├── Output writers: OrderedDict with no entries
└── Diagnostics: OrderedDict with no entries</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; show_time(sim) = @info &quot;Time is $(prettytime(sim.model.clock.time))&quot;</code><code class="nohighlight hljs ansi" style="display:block;">show_time (generic function with 1 method)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; simulation.callbacks[:total_A] = Callback(show_time, IterationInterval(2))</code><code class="nohighlight hljs ansi" style="display:block;">Callback of show_time on IterationInterval(2)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; run!(simulation)</code><code class="nohighlight hljs ansi" style="display:block;"><span class="sgr36"><span class="sgr1">[ Info: </span></span>Initializing simulation...
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Time is 0 seconds
<span class="sgr36"><span class="sgr1">[ Info: </span></span>    ... simulation initialization complete (152.267 ms)
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Executing initial time step...
<span class="sgr36"><span class="sgr1">[ Info: </span></span>    ... initial time step complete (6.052 seconds).
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Time is 2 seconds
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Time is 4 seconds
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Time is 6 seconds
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Time is 8 seconds
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Simulation is stopping after running for 6.256 seconds.
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Model iteration 10 equals or exceeds stop iteration 10.
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Time is 10 seconds</code></pre><p>State callbacks are useful for inter step modification of the model state (for example if you wanted to manually modify the tendency fields). Irrespective of the specified scheduling state callbacks are executed at every sub-step. As an example we can manually add to the tendency field of one of the velocity components, here I&#39;ve chosen the <code>:u</code> field using parameters:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using Oceananigans</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; model = NonhydrostaticModel(grid=RectilinearGrid(size=(1, 1, 1), extent=(1, 1, 1)))</code><code class="nohighlight hljs ansi" style="display:block;">NonhydrostaticModel{CPU, RectilinearGrid}(time = 0 seconds, iteration = 0)
├── grid: 1×1×1 RectilinearGrid{Float64, Periodic, Periodic, Bounded} on CPU with 3×3×3 halo
├── timestepper: QuasiAdamsBashforth2TimeStepper
├── tracers: ()
├── closure: Nothing
├── buoyancy: Nothing
└── coriolis: Nothing</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; function modify_tracer(model, params)
           model.timestepper.Gⁿ[params.c] .+= params.δ
       end</code><code class="nohighlight hljs ansi" style="display:block;">modify_tracer (generic function with 1 method)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; model.state_callbacks[:modify_u] = Callback(modify_tracer, IterationInterval(1), (c = :u, δ = 1))</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: MethodError: no method matching Callback(::typeof(Main.modify_tracer), ::IterationInterval, ::NamedTuple{(:c, :δ), Tuple{Symbol, Int64}})

Closest candidates are:
  Callback(::F, ::S, ::P, <span class="sgr91">::CS</span>) where {P, F, S, CS}
<span class="sgr90">   @</span> <span class="sgr35">Oceananigans</span> <span class="sgr90">~/builds/tartarus-5/clima/oceananigans/src/Simulations/<span class="sgr4">callback.jl:8</span></span>
  Callback(::Any, ::Any; parameters, callsite)
<span class="sgr90">   @</span> <span class="sgr35">Oceananigans</span> <span class="sgr90">~/builds/tartarus-5/clima/oceananigans/src/Simulations/<span class="sgr4">callback.jl:46</span></span>
  Callback(<span class="sgr91">::WindowedTimeAverage</span>, ::Any; kw...)
<span class="sgr90">   @</span> <span class="sgr35">Oceananigans</span> <span class="sgr90">~/builds/tartarus-5/clima/oceananigans/src/Simulations/<span class="sgr4">callback.jl:68</span></span>
  ...</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; simulation = Simulation(model, Δt=1, stop_iteration=10)</code><code class="nohighlight hljs ansi" style="display:block;">Simulation of NonhydrostaticModel{CPU, RectilinearGrid}(time = 0 seconds, iteration = 0)
├── Next time step: 1 second
├── Elapsed wall time: 0 seconds
├── Wall time per iteration: NaN days
├── Stop time: Inf days
├── Stop iteration : 10.0
├── Wall time limit: Inf
├── Callbacks: OrderedDict with 4 entries:
│   ├── stop_time_exceeded =&gt; Callback of stop_time_exceeded on IterationInterval(1)
│   ├── stop_iteration_exceeded =&gt; Callback of stop_iteration_exceeded on IterationInterval(1)
│   ├── wall_time_limit_exceeded =&gt; Callback of wall_time_limit_exceeded on IterationInterval(1)
│   └── nan_checker =&gt; Callback of NaNChecker for u on IterationInterval(100)
├── Output writers: OrderedDict with no entries
└── Diagnostics: OrderedDict with no entries</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; run!(simulation)</code><code class="nohighlight hljs ansi" style="display:block;"><span class="sgr36"><span class="sgr1">[ Info: </span></span>Initializing simulation...
<span class="sgr36"><span class="sgr1">[ Info: </span></span>    ... simulation initialization complete (861.909 μs)
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Executing initial time step...
<span class="sgr36"><span class="sgr1">[ Info: </span></span>    ... initial time step complete (1.604 ms).
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Simulation is stopping after running for 10.431 ms.
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Model iteration 10 equals or exceeds stop iteration 10.</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; @info model.velocities.u</code><code class="nohighlight hljs ansi" style="display:block;"><span class="sgr36"><span class="sgr1">┌ Info: </span></span>1×1×1 Field{Face, Center, Center} on RectilinearGrid on CPU
<span class="sgr36"><span class="sgr1">│ </span></span>├── grid: 1×1×1 RectilinearGrid{Float64, Periodic, Periodic, Bounded} on CPU with 3×3×3 halo
<span class="sgr36"><span class="sgr1">│ </span></span>├── boundary conditions: FieldBoundaryConditions
<span class="sgr36"><span class="sgr1">│ </span></span>│   └── west: Periodic, east: Periodic, south: Periodic, north: Periodic, bottom: ZeroFlux, top: ZeroFlux, immersed: ZeroFlux
<span class="sgr36"><span class="sgr1">│ </span></span>└── data: 7×7×7 OffsetArray(::Array{Float64, 3}, -2:4, -2:4, -2:4) with eltype Float64 with indices -2:4×-2:4×-2:4
<span class="sgr36"><span class="sgr1">└ </span></span>    └── max=0.0, min=0.0, mean=0.0</code></pre><p>Here there is no forcing, but due to the callback the velocity is increased. </p><blockquote><p>This is a redundant example and here for illustration only, it could be implemented better with a simple forcing function.</p></blockquote><h2 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h2><p>Callback functions can only take one or two parameters <code>sim</code> - a simulation, or <code>model</code> for state callbacks, and optionally may also accept a NamedTuple of parameters.</p><h2 id="Scheduling"><a class="docs-heading-anchor" href="#Scheduling">Scheduling</a><a id="Scheduling-1"></a><a class="docs-heading-anchor-permalink" href="#Scheduling" title="Permalink"></a></h2><p>The time that callbacks are called at are specified by schedule functions which can be:</p><ul><li><a href="../../appendix/library/#Oceananigans.Utils.IterationInterval-Tuple{Any}"><code>IterationInterval</code></a> : runs every <code>n</code> iterations</li><li><a href="../../appendix/library/#Oceananigans.Utils.TimeInterval"><code>TimeInterval</code></a> : runs every <code>n</code>s of model run time</li><li><a href="../../appendix/library/#Oceananigans.Utils.SpecifiedTimes-Union{Tuple{Vararg{T}}, Tuple{T}} where T&lt;:Number"><code>SpecifiedTimes</code></a> : runs at the specified times</li><li><a href="../../appendix/library/#Oceananigans.Utils.WallTimeInterval-Tuple{Any}"><code>WallTimeInterval</code></a> : runs every <code>n</code>s of wall time</li></ul><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using Oceananigans, Oceananigans.Units</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; model = NonhydrostaticModel(grid=RectilinearGrid(size=(16, 16, 16), extent=(1, 1, 1)))</code><code class="nohighlight hljs ansi" style="display:block;">NonhydrostaticModel{CPU, RectilinearGrid}(time = 0 seconds, iteration = 0)
├── grid: 16×16×16 RectilinearGrid{Float64, Periodic, Periodic, Bounded} on CPU with 3×3×3 halo
├── timestepper: QuasiAdamsBashforth2TimeStepper
├── tracers: ()
├── closure: Nothing
├── buoyancy: Nothing
└── coriolis: Nothing</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; simulation = Simulation(model, Δt=1, stop_iteration=1)</code><code class="nohighlight hljs ansi" style="display:block;">Simulation of NonhydrostaticModel{CPU, RectilinearGrid}(time = 0 seconds, iteration = 0)
├── Next time step: 1 second
├── Elapsed wall time: 0 seconds
├── Wall time per iteration: NaN days
├── Stop time: Inf days
├── Stop iteration : 1.0
├── Wall time limit: Inf
├── Callbacks: OrderedDict with 4 entries:
│   ├── stop_time_exceeded =&gt; Callback of stop_time_exceeded on IterationInterval(1)
│   ├── stop_iteration_exceeded =&gt; Callback of stop_iteration_exceeded on IterationInterval(1)
│   ├── wall_time_limit_exceeded =&gt; Callback of wall_time_limit_exceeded on IterationInterval(1)
│   └── nan_checker =&gt; Callback of NaNChecker for u on IterationInterval(100)
├── Output writers: OrderedDict with no entries
└── Diagnostics: OrderedDict with no entries</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; simulation.output_writers[:checkpointer] = Checkpointer(model, schedule=TimeInterval(5days), prefix=&quot;model_checkpoint&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">Checkpointer{TimeInterval, Vector{Symbol}}(TimeInterval(432000.0, 0.0), &quot;.&quot;, &quot;model_checkpoint&quot;, [:architecture, :grid, :clock, :coriolis, :buoyancy, :closure, :timestepper, :particles], false, false, false)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; run!(simulation)</code><code class="nohighlight hljs ansi" style="display:block;"><span class="sgr36"><span class="sgr1">[ Info: </span></span>Initializing simulation...
<span class="sgr36"><span class="sgr1">[ Info: </span></span>    ... simulation initialization complete (2.934 seconds)
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Executing initial time step...
<span class="sgr36"><span class="sgr1">[ Info: </span></span>    ... initial time step complete (1.906 seconds).
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Simulation is stopping after running for 0 seconds.
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Model iteration 1 equals or exceeds stop iteration 1.</code></pre><p>The default options should provide checkpoint files that are easy to restore from in most cases. For more advanced options and features, see <a href="../../appendix/library/#Oceananigans.OutputWriters.Checkpointer-Tuple{Any}"><code>Checkpointer</code></a>.</p><h2 id="Picking-up-a-simulation-from-a-checkpoint-file"><a class="docs-heading-anchor" href="#Picking-up-a-simulation-from-a-checkpoint-file">Picking up a simulation from a checkpoint file</a><a id="Picking-up-a-simulation-from-a-checkpoint-file-1"></a><a class="docs-heading-anchor-permalink" href="#Picking-up-a-simulation-from-a-checkpoint-file" title="Permalink"></a></h2><p>Picking up a simulation from a checkpoint requires the original script that was used to generate the checkpoint data. Change the first instance of <a href="../../appendix/library/#Oceananigans.Simulations.run!-Tuple{Any}"><code>run!</code></a> in the script to take <code>pickup=true</code>:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; simulation.stop_iteration = 2</code><code class="nohighlight hljs ansi" style="display:block;">2</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; run!(simulation, pickup=true)</code><code class="nohighlight hljs ansi" style="display:block;"><span class="sgr36"><span class="sgr1">[ Info: </span></span>Initializing simulation...
<span class="sgr36"><span class="sgr1">[ Info: </span></span>    ... simulation initialization complete (13.565 ms)
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Executing initial time step...
<span class="sgr36"><span class="sgr1">[ Info: </span></span>    ... initial time step complete (3.164 ms).
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Simulation is stopping after running for 17.246 ms.
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Model iteration 2 equals or exceeds stop iteration 2.</code></pre><p>which finds the latest checkpoint file in the current working directory (in this trivial case, this is the checkpoint associated with iteration 0), loads prognostic fields and their tendencies from file, resets the model clock and iteration, and updates the model auxiliary state before starting the time-stepping loop.</p><p>Use <code>pickup=iteration</code>, where <code>iteration</code> is an <code>Integer</code>, to pick up from a specific iteration. Or, use <code>pickup=filepath</code>, where <code>filepath</code> is a string, to pickup from a specific file located at <code>filepath</code>.</p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Friday 26 January 2024 06:45">Friday 26 January 2024</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
